{
  "code_examples": [
    {
      "input": "import java.util.*;\n\nenum CharacterType { WARRIOR, MAGE, ARCHER, ROGUE }\nenum SkillType { BASIC, SPECIAL, SUPPORT }\nenum WeaponType { SWORD, STAFF, BOW, DAGGER }\nenum PetType { WOLF, FAIRY, HAWK, SHADOW_CAT }\n\nclass Stats {\n    int hp, mp, atk, mag, def, res, spd, crit;\n    Stats(int hp,int mp,int atk,int mag,int def,int res,int spd,int crit){\n        this.hp=hp; this.mp=mp; this.atk=atk; this.mag=mag; this.def=def; this.res=res; this.spd=spd; this.crit=crit;\n    }\n    Stats copy(){ return new Stats(hp,mp,atk,mag,def,res,spd,crit); }\n}\n\nclass Skill {\n    final String name; final SkillType type; final int cost;\n    Skill(String n, SkillType t, int c){ name=n; type=t; cost=c; }\n}\n\nclass Weapon {\n    final String name; final WeaponType type; final int power;\n    Weapon(String n, WeaponType t, int p){ name=n; type=t; power=p; }\n}\n\nclass Pet {\n    final String name; final PetType type; final int bond;\n    Pet(String n, PetType t, int b){ name=n; type=t; bond=b; }\n}\n\nclass Enemy {\n    final String name; final Stats stats;\n    Enemy(String n, Stats s){ name=n; stats=s; }\n}\n\nclass GameCharacter {\n    final String name; final CharacterType type; final int level; final Stats stats;\n    final List<Skill> skills; final Weapon weapon; final Pet pet;\n    GameCharacter(String n, CharacterType t, int lvl, Stats s, List<Skill> k, Weapon w, Pet p){\n        name=n; type=t; level=lvl; stats=s; skills=k; weapon=w; pet=p;\n    }\n}\n\nclass PetBoostSystem {\n    int offenseBoost(GameCharacter c){\n        switch(c.pet.type){\n            case WOLF: return (int)(c.stats.atk * Math.min(0.25, 0.05 + c.pet.bond/100.0));\n            case FAIRY: return (int)(c.stats.mag * Math.min(0.25, 0.05 + c.pet.bond/120.0));\n            case HAWK: return c.stats.spd/3 + c.pet.bond/6;\n            case SHADOW_CAT: return 5 + c.pet.bond/5;\n        }\n        return 0;\n    }\n    int defenseBoost(GameCharacter c){\n        switch(c.pet.type){\n            case WOLF: return c.stats.def/6;\n            case FAIRY: return c.stats.res/4;\n            case HAWK: return c.stats.spd/6;\n            case SHADOW_CAT: return 3;\n        }\n        return 0;\n    }\n    boolean petAssist(GameCharacter c){\n        switch(c.pet.type){\n            case WOLF: return new Random().nextInt(100) < Math.min(35, 10 + c.pet.bond/3);\n            case FAIRY: return new Random().nextInt(100) < Math.min(40, 15 + c.pet.bond/2);\n            case HAWK: return new Random().nextInt(100) < Math.min(30, 8 + c.pet.bond/4);\n            case SHADOW_CAT: return new Random().nextInt(100) < Math.min(45, 12 + c.pet.bond/2);\n        }\n        return false;\n    }\n    int petAssistDamage(GameCharacter c){\n        switch(c.pet.type){\n            case WOLF: return 6 + c.pet.bond/4;\n            case FAIRY: return 4 + c.pet.bond/5;\n            case HAWK: return 5 + c.pet.bond/6;\n            case SHADOW_CAT: return 7 + c.pet.bond/5;\n        }\n        return 0;\n    }\n    int petAssistHeal(GameCharacter c){\n        switch(c.pet.type){\n            case FAIRY: return 8 + c.pet.bond/3;\n            default: return 0;\n        }\n    }\n}\n\nclass WeaponRuleSet {\n    int applyWeapon(GameCharacter c, int base){\n        switch(c.weapon.type){\n            case SWORD: return base + c.weapon.power + c.stats.atk/4;\n            case STAFF: return base + c.weapon.power/2 + c.stats.mag/2;\n            case BOW: return base + c.weapon.power + c.stats.spd/3;\n            case DAGGER: return base + c.weapon.power + c.stats.spd/2;\n        }\n        return base;\n    }\n    int critChance(GameCharacter c){\n        switch(c.weapon.type){\n            case SWORD: return 8 + c.stats.crit;\n            case STAFF: return 5 + c.stats.crit/2;\n            case BOW: return 15 + c.stats.crit;\n            case DAGGER: return 18 + c.stats.crit;\n        }\n        return 0;\n    }\n}\n\nclass DamageCalculator {\n    final Random rng = new Random();\n    final WeaponRuleSet wr = new WeaponRuleSet();\n    final PetBoostSystem pets = new PetBoostSystem();\n\n    int calc(GameCharacter c, Skill s, Enemy e){\n        int base;\n        switch(c.type){\n            case WARRIOR:\n                base = (int)(c.stats.atk * (1.1 + c.level*0.03)) - e.stats.def/3;\n                if(s.type==SkillType.SPECIAL) base += 12;\n                break;\n            case MAGE:\n                base = c.stats.mag*2 + (s.type==SkillType.SPECIAL?18:0) - e.stats.res/2;\n                break;\n            case ARCHER:\n                base = c.stats.atk + c.stats.spd/2 + (s.type==SkillType.SPECIAL?10:0) - e.stats.def/4;\n                break;\n            case ROGUE:\n                base = c.stats.atk + c.stats.spd + (s.type==SkillType.SPECIAL?14:0) - e.stats.def/5;\n                break;\n            default:\n                base = 0;\n        }\n        base = wr.applyWeapon(c, base);\n        base += pets.offenseBoost(c);\n        if (pets.petAssist(c)) base += pets.petAssistDamage(c);\n        int critChance = wr.critChance(c) + (c.type==CharacterType.ARCHER?10:0);\n        if (rng.nextInt(100) < critChance) base *= 2;\n        return Math.max(0, base);\n    }\n}\n\nclass HealCalculator {\n    final PetBoostSystem pets = new PetBoostSystem();\n    int heal(GameCharacter c, Skill s){\n        int amt;\n        switch(c.type){\n            case WARRIOR: amt = c.stats.atk/3 + 6; break;\n            case MAGE: amt = c.stats.mag + 14; break;\n            case ARCHER: amt = c.stats.atk/4 + c.stats.spd/5; break;\n            case ROGUE: amt = c.stats.atk/2; break;\n            default: amt = 0;\n        }\n        if (s.type==SkillType.SPECIAL) amt += 6;\n        amt += pets.defenseBoost(c)/2 + pets.petAssistHeal(c);\n        return Math.max(0, amt);\n    }\n}\n\nclass LootCalculator {\n    int gold(GameCharacter c, Enemy e){\n        switch(c.type){\n            case WARRIOR: return 10 + c.level + e.stats.def/5;\n            case MAGE: return 9 + c.level*2 + e.stats.res/4;\n            case ARCHER: return 11 + c.level + e.stats.def/6;\n            case ROGUE: return 14 + c.level;\n        }\n        return 0;\n    }\n}\n\nclass TargetingSystem {\n    Enemy pick(List<Enemy> enemies){\n        Enemy t = enemies.get(0);\n        for(Enemy e: enemies) if(e.stats.hp < t.stats.hp) t=e;\n        return t;\n    }\n}\n\nclass SkillSelector {\n    Skill choose(GameCharacter c){\n        for(Skill s: c.skills) if(s.type!=SkillType.BASIC) return s;\n        return c.skills.get(0);\n    }\n}\n\nclass TurnEngine {\n    final DamageCalculator dmg=new DamageCalculator();\n    final HealCalculator healCalc=new HealCalculator();\n    final LootCalculator loot=new LootCalculator();\n    final TargetingSystem targeting=new TargetingSystem();\n    final SkillSelector selector=new SkillSelector();\n\n    void turn(List<GameCharacter> party, List<Enemy> enemies){\n        for(GameCharacter c: party){\n            Skill s = selector.choose(c);\n            if(s.type==SkillType.SUPPORT){\n                int h = healCalc.heal(c,s);\n                c.stats.hp += h;\n                continue;\n            }\n            Enemy target = targeting.pick(enemies);\n            int d = dmg.calc(c,s,target);\n            target.stats.hp = Math.max(0, target.stats.hp - d);\n        }\n    }\n    int totalGold(List<GameCharacter> party, Enemy e){\n        int g=0; for(GameCharacter c: party) g+=loot.gold(c,e); return g;\n    }\n}",
      "output": "import java.util.*;\n\nenum CharacterType { WARRIOR, MAGE, ARCHER, ROGUE }\nenum SkillType { BASIC, SPECIAL, SUPPORT }\nenum WeaponType { SWORD, STAFF, BOW, DAGGER }\nenum PetType { WOLF, FAIRY, HAWK, SHADOW_CAT }\n\nclass Stats {\n    int hp, mp, atk, mag, def, res, spd, crit;\n    Stats(int hp,int mp,int atk,int mag,int def,int res,int spd,int crit){\n        this.hp=hp; this.mp=mp; this.atk=atk; this.mag=mag; this.def=def; this.res=res; this.spd=spd; this.crit=crit;\n    }\n    Stats copy(){ return new Stats(hp,mp,atk,mag,def,res,spd,crit); }\n}\n\nclass Skill {\n    final String name; final SkillType type; final int cost;\n    Skill(String n, SkillType t, int c){ name=n; type=t; cost=c; }\n}\n\nclass Weapon {\n    final String name; final WeaponType type; final int power;\n    Weapon(String n, WeaponType t, int p){ name=n; type=t; power=p; }\n}\n\nclass Pet {\n    final String name; final PetType type; final int bond;\n    Pet(String n, PetType t, int b){ name=n; type=t; bond=b; }\n}\n\nclass Enemy {\n    final String name; final Stats stats;\n    Enemy(String n, Stats s){ name=n; stats=s; }\n}\n\ninterface PetLogic {\n    int offenseBoost(GameCharacter c);\n    int defenseBoost(GameCharacter c);\n    boolean assist(GameCharacter c);\n    int assistDamage(GameCharacter c);\n    int assistHeal(GameCharacter c);\n}\n\nclass WolfPetLogic implements PetLogic {\n    public int offenseBoost(GameCharacter c){\n        return (int)(c.stats.atk * Math.min(0.25, 0.05 + c.pet.bond/100.0));\n    }\n    public int defenseBoost(GameCharacter c){\n        return c.stats.def/6;\n    }\n    public boolean assist(GameCharacter c){\n        return new Random().nextInt(100) < Math.min(35, 10 + c.pet.bond/3);\n    }\n    public int assistDamage(GameCharacter c){\n        return 6 + c.pet.bond/4;\n    }\n    public int assistHeal(GameCharacter c){\n        return 0;\n    }\n}\n\nclass FairyPetLogic implements PetLogic {\n    public int offenseBoost(GameCharacter c){\n        return (int)(c.stats.mag * Math.min(0.25, 0.05 + c.pet.bond/120.0));\n    }\n    public int defenseBoost(GameCharacter c){\n        return c.stats.res/4;\n    }\n    public boolean assist(GameCharacter c){\n        return new Random().nextInt(100) < Math.min(40, 15 + c.pet.bond/2);\n    }\n    public int assistDamage(GameCharacter c){\n        return 4 + c.pet.bond/5;\n    }\n    public int assistHeal(GameCharacter c){\n        return 8 + c.pet.bond/3;\n    }\n}\n\nclass HawkPetLogic implements PetLogic {\n    public int offenseBoost(GameCharacter c){\n        return c.stats.spd/3 + c.pet.bond/6;\n    }\n    public int defenseBoost(GameCharacter c){\n        return c.stats.spd/6;\n    }\n    public boolean assist(GameCharacter c){\n        return new Random().nextInt(100) < Math.min(30, 8 + c.pet.bond/4);\n    }\n    public int assistDamage(GameCharacter c){\n        return 5 + c.pet.bond/6;\n    }\n    public int assistHeal(GameCharacter c){\n        return 0;\n    }\n}\n\nclass ShadowCatPetLogic implements PetLogic {\n    public int offenseBoost(GameCharacter c){\n        return 5 + c.pet.bond/5;\n    }\n    public int defenseBoost(GameCharacter c){\n        return 3;\n    }\n    public boolean assist(GameCharacter c){\n        return new Random().nextInt(100) < Math.min(45, 12 + c.pet.bond/2);\n    }\n    public int assistDamage(GameCharacter c){\n        return 7 + c.pet.bond/5;\n    }\n    public int assistHeal(GameCharacter c){\n        return 0;\n    }\n}\n\nclass PetLogicRegistry {\n    private static final Map<PetType, PetLogic> map = new EnumMap<>(PetType.class);\n    static {\n        map.put(PetType.WOLF, new WolfPetLogic());\n        map.put(PetType.FAIRY, new FairyPetLogic());\n        map.put(PetType.HAWK, new HawkPetLogic());\n        map.put(PetType.SHADOW_CAT, new ShadowCatPetLogic());\n    }\n    static PetLogic of(PetType t){ return map.get(t); }\n}\n\ninterface WeaponLogic {\n    int applyWeapon(GameCharacter c, int base);\n    int critChance(GameCharacter c);\n}\n\nclass SwordLogic implements WeaponLogic {\n    public int applyWeapon(GameCharacter c, int base){\n        return base + c.weapon.power + c.stats.atk/4;\n    }\n    public int critChance(GameCharacter c){\n        return 8 + c.stats.crit;\n    }\n}\n\nclass StaffLogic implements WeaponLogic {\n    public int applyWeapon(GameCharacter c, int base){\n        return base + c.weapon.power/2 + c.stats.mag/2;\n    }\n    public int critChance(GameCharacter c){\n        return 5 + c.stats.crit/2;\n    }\n}\n\nclass BowLogic implements WeaponLogic {\n    public int applyWeapon(GameCharacter c, int base){\n        return base + c.weapon.power + c.stats.spd/3;\n    }\n    public int critChance(GameCharacter c){\n        return 15 + c.stats.crit;\n    }\n}\n\nclass DaggerLogic implements WeaponLogic {\n    public int applyWeapon(GameCharacter c, int base){\n        return base + c.weapon.power + c.stats.spd/2;\n    }\n    public int critChance(GameCharacter c){\n        return 18 + c.stats.crit;\n    }\n}\n\nclass WeaponLogicRegistry {\n    private static final Map<WeaponType, WeaponLogic> map = new EnumMap<>(WeaponType.class);\n    static {\n        map.put(WeaponType.SWORD, new SwordLogic());\n        map.put(WeaponType.STAFF, new StaffLogic());\n        map.put(WeaponType.BOW, new BowLogic());\n        map.put(WeaponType.DAGGER, new DaggerLogic());\n    }\n    static WeaponLogic of(WeaponType t){ return map.get(t); }\n}\n\ninterface RoleLogic {\n    int baseDamage(GameCharacter c, Skill s, Enemy e);\n    int baseHeal(GameCharacter c, Skill s);\n    int gold(GameCharacter c, Enemy e);\n    int extraCrit(GameCharacter c);\n}\n\nclass WarriorLogic implements RoleLogic {\n    public int baseDamage(GameCharacter c, Skill s, Enemy e){\n        int base = (int)(c.stats.atk * (1.1 + c.level*0.03)) - e.stats.def/3;\n        if(s.type==SkillType.SPECIAL) base += 12;\n        return base;\n    }\n    public int baseHeal(GameCharacter c, Skill s){\n        int amt = c.stats.atk/3 + 6;\n        if (s.type==SkillType.SPECIAL) amt += 6;\n        return amt;\n    }\n    public int gold(GameCharacter c, Enemy e){\n        return 10 + c.level + e.stats.def/5;\n    }\n    public int extraCrit(GameCharacter c){ return 0; }\n}\n\nclass MageLogic implements RoleLogic {\n    public int baseDamage(GameCharacter c, Skill s, Enemy e){\n        int base = c.stats.mag*2 + (s.type==SkillType.SPECIAL?18:0) - e.stats.res/2;\n        return base;\n    }\n    public int baseHeal(GameCharacter c, Skill s){\n        int amt = c.stats.mag + 14;\n        if (s.type==SkillType.SPECIAL) amt += 6;\n        return amt;\n    }\n    public int gold(GameCharacter c, Enemy e){\n        return 9 + c.level*2 + e.stats.res/4;\n    }\n    public int extraCrit(GameCharacter c){ return 0; }\n}\n\nclass ArcherLogic implements RoleLogic {\n    public int baseDamage(GameCharacter c, Skill s, Enemy e){\n        int base = c.stats.atk + c.stats.spd/2 + (s.type==SkillType.SPECIAL?10:0) - e.stats.def/4;\n        return base;\n    }\n    public int baseHeal(GameCharacter c, Skill s){\n        int amt = c.stats.atk/4 + c.stats.spd/5;\n        if (s.type==SkillType.SPECIAL) amt += 6;\n        return amt;\n    }\n    public int gold(GameCharacter c, Enemy e){\n        return 11 + c.level + e.stats.def/6;\n    }\n    public int extraCrit(GameCharacter c){ return 10; }\n}\n\nclass RogueLogic implements RoleLogic {\n    public int baseDamage(GameCharacter c, Skill s, Enemy e){\n        int base = c.stats.atk + c.stats.spd + (s.type==SkillType.SPECIAL?14:0) - e.stats.def/5;\n        return base;\n    }\n    public int baseHeal(GameCharacter c, Skill s){\n        int amt = c.stats.atk/2;\n        if (s.type==SkillType.SPECIAL) amt += 6;\n        return amt;\n    }\n    public int gold(GameCharacter c, Enemy e){\n        return 14 + c.level;\n    }\n    public int extraCrit(GameCharacter c){ return 0; }\n}\n\nclass RoleLogicRegistry {\n    private static final Map<CharacterType, RoleLogic> map = new EnumMap<>(CharacterType.class);\n    static {\n        map.put(CharacterType.WARRIOR, new WarriorLogic());\n        map.put(CharacterType.MAGE, new MageLogic());\n        map.put(CharacterType.ARCHER, new ArcherLogic());\n        map.put(CharacterType.ROGUE, new RogueLogic());\n    }\n    static RoleLogic of(CharacterType t){ return map.get(t); }\n}\n\nclass GameCharacter {\n    final String name; final CharacterType type; final int level; final Stats stats;\n    final List<Skill> skills; final Weapon weapon; final Pet pet;\n    GameCharacter(String n, CharacterType t, int lvl, Stats s, List<Skill> k, Weapon w, Pet p){\n        name=n; type=t; level=lvl; stats=s; skills=k; weapon=w; pet=p;\n    }\n}\n\nclass PetBoostSystem {\n    int offenseBoost(GameCharacter c){\n        return PetLogicRegistry.of(c.pet.type).offenseBoost(c);\n    }\n    int defenseBoost(GameCharacter c){\n        return PetLogicRegistry.of(c.pet.type).defenseBoost(c);\n    }\n    boolean petAssist(GameCharacter c){\n        return PetLogicRegistry.of(c.pet.type).assist(c);\n    }\n    int petAssistDamage(GameCharacter c){\n        return PetLogicRegistry.of(c.pet.type).assistDamage(c);\n    }\n    int petAssistHeal(GameCharacter c){\n        return PetLogicRegistry.of(c.pet.type).assistHeal(c);\n    }\n}\n\nclass WeaponRuleSet {\n    int applyWeapon(GameCharacter c, int base){\n        return WeaponLogicRegistry.of(c.weapon.type).applyWeapon(c, base);\n    }\n    int critChance(GameCharacter c){\n        return WeaponLogicRegistry.of(c.weapon.type).critChance(c);\n    }\n}\n\nclass RoleRuleSet {\n    int baseDamage(GameCharacter c, Skill s, Enemy e){\n        return RoleLogicRegistry.of(c.type).baseDamage(c, s, e);\n    }\n    int baseHeal(GameCharacter c, Skill s){\n        return RoleLogicRegistry.of(c.type).baseHeal(c, s);\n    }\n    int gold(GameCharacter c, Enemy e){\n        return RoleLogicRegistry.of(c.type).gold(c, e);\n    }\n    int extraCrit(GameCharacter c){\n        return RoleLogicRegistry.of(c.type).extraCrit(c);\n    }\n}\n\nclass DamageCalculator {\n    final Random rng = new Random();\n    final WeaponRuleSet wr = new WeaponRuleSet();\n    final PetBoostSystem pets = new PetBoostSystem();\n    final RoleRuleSet roles = new RoleRuleSet();\n\n    int calc(GameCharacter c, Skill s, Enemy e){\n        int base = roles.baseDamage(c, s, e);\n        base = wr.applyWeapon(c, base);\n        base += pets.offenseBoost(c);\n        if (pets.petAssist(c)) base += pets.petAssistDamage(c);\n        int critChance = wr.critChance(c) + roles.extraCrit(c);\n        if (rng.nextInt(100) < critChance) base *= 2;\n        return Math.max(0, base);\n    }\n}\n\nclass HealCalculator {\n    final PetBoostSystem pets = new PetBoostSystem();\n    final RoleRuleSet roles = new RoleRuleSet();\n    int heal(GameCharacter c, Skill s){\n        int amt = roles.baseHeal(c, s);\n        amt += pets.defenseBoost(c)/2 + pets.petAssistHeal(c);\n        return Math.max(0, amt);\n    }\n}\n\nclass LootCalculator {\n    final RoleRuleSet roles = new RoleRuleSet();\n    int gold(GameCharacter c, Enemy e){\n        return roles.gold(c, e);\n    }\n}\n\nclass TargetingSystem {\n    Enemy pick(List<Enemy> enemies){\n        Enemy t = enemies.get(0);\n        for(Enemy e: enemies) if(e.stats.hp < t.stats.hp) t=e;\n        return t;\n    }\n}\n\nclass SkillSelector {\n    Skill choose(GameCharacter c){\n        for(Skill s: c.skills) if(s.type!=SkillType.BASIC) return s;\n        return c.skills.get(0);\n    }\n}\n\nclass TurnEngine {\n    final DamageCalculator dmg=new DamageCalculator();\n    final HealCalculator healCalc=new HealCalculator();\n    final LootCalculator loot=new LootCalculator();\n    final TargetingSystem targeting=new TargetingSystem();\n    final SkillSelector selector=new SkillSelector();\n\n    void turn(List<GameCharacter> party, List<Enemy> enemies){\n        for(GameCharacter c: party){\n            Skill s = selector.choose(c);\n            if(s.type==SkillType.SUPPORT){\n                int h = healCalc.heal(c,s);\n                c.stats.hp += h;\n                continue;\n            }\n            Enemy target = targeting.pick(enemies);\n            int d = dmg.calc(c,s,target);\n            target.stats.hp = Math.max(0, target.stats.hp - d);\n        }\n    }\n    int totalGold(List<GameCharacter> party, Enemy e){\n        int g=0; for(GameCharacter c: party) g+=loot.gold(c,e); return g;\n    }\n}\n",
      "level": "HARD",
      "language": "JAVA",
      "violation": "OCP"
    },
    {
      "input": "abstract class GraphicObject {\n    private final String color;\n\n    protected GraphicObject(String color) {\n        this.color = color;\n    }\n\n    public String getColor() {\n        return color;\n    }\n}\n\nenum ShapeKind {\n    RECTANGLE, CIRCLE, CUBE\n}\n\nabstract class Shape extends GraphicObject {\n    private final ShapeKind kind;\n\n    protected Shape(ShapeKind kind, String color) {\n        super(color);\n        this.kind = kind;\n    }\n\n    public ShapeKind getKind() {\n        return kind;\n    }\n}\n\nabstract class TwoDShape extends Shape {\n    protected TwoDShape(ShapeKind kind, String color) {\n        super(kind, color);\n    }\n}\n\nabstract class ThreeDShape extends Shape {\n    protected ThreeDShape(ShapeKind kind, String color) {\n        super(kind, color);\n    }\n}\n\n\nclass Rectangle extends TwoDShape {\n    private final double width;\n    private final double height;\n\n    public Rectangle(double width, double height, String color) {\n        super(ShapeKind.RECTANGLE, color);\n        this.width = width;\n        this.height = height;\n    }\n\n    public double getWidth()  { return width;  }\n    public double getHeight() { return height; }\n}\n\nclass Circle extends TwoDShape {\n    private final double radius;\n\n    public Circle(double radius, String color) {\n        super(ShapeKind.CIRCLE, color);\n        this.radius = radius;\n    }\n\n    public double getRadius() { return radius; }\n}\n\nclass Cube extends ThreeDShape {\n    private final double edge;\n\n    public Cube(double edge, String color) {\n        super(ShapeKind.CUBE, color);\n        this.edge = edge;\n    }\n\n    public double getEdge() { return edge; }\n}\n\nenum Metric { AREA, PERIMETER, VOLUME }\n\nclass MetricCalculator {\n    public double compute(Shape shape, Metric metric) {\n        switch (shape.getKind()) {\n            case RECTANGLE: {\n                Rectangle r = (Rectangle) shape;\n                return switch (metric) {\n                    case AREA      -> r.getWidth() * r.getHeight();\n                    case PERIMETER -> 2 * (r.getWidth() + r.getHeight());\n                    case VOLUME    -> 0;\n                };\n            }\n            case CIRCLE: {\n                Circle c = (Circle) shape;\n                return switch (metric) {\n                    case AREA      -> Math.PI * c.getRadius() * c.getRadius();\n                    case PERIMETER -> 2 * Math.PI * c.getRadius(); \n                    case VOLUME    -> 0;\n                };\n            }\n            case CUBE: {\n                Cube cube = (Cube) shape;\n                return switch (metric) {\n                    case AREA      -> 6 * cube.getEdge() * cube.getEdge();\n                    case PERIMETER -> 12 * cube.getEdge();\n                    case VOLUME    -> Math.pow(cube.getEdge(), 3);\n                };\n            }\n            default:\n                return 0;\n        }\n    }\n}\n\nclass ShapeExporter {\n    public String toJson(Shape shape) {\n        switch (shape.getKind()) {\n            case RECTANGLE: {\n                Rectangle r = (Rectangle) shape;\n                return String.format(\n                    \"{\\\"type\\\":\\\"rectangle\\\",\\\"color\\\":\\\"%s\\\",\\\"width\\\":%.2f,\\\"height\\\":%.2f}\",\n                    r.getColor(), r.getWidth(), r.getHeight()\n                );\n            }\n            case CIRCLE: {\n                Circle c = (Circle) shape;\n                return String.format(\n                    \"{\\\"type\\\":\\\"circle\\\",\\\"color\\\":\\\"%s\\\",\\\"radius\\\":%.2f}\",\n                    c.getColor(), c.getRadius()\n                );\n            }\n            case CUBE: {\n                Cube cube = (Cube) shape;\n                return String.format(\n                    \"{\\\"type\\\":\\\"cube\\\",\\\"color\\\":\\\"%s\\\",\\\"edge\\\":%.2f}\",\n                    cube.getColor(), cube.getEdge()\n                );\n            }\n            default:\n                return \"{}\";\n        }\n    }\n}\n\nclass ShapeFactory {\n    public Shape create(String spec) {\n        String[] parts = spec.split(\":\", 2);\n        String type = parts[0].trim();\n        String[] kvs = (parts.length > 1 ? parts[1] : \"\").split(\";\");\n        java.util.Map<String, String> map = new java.util.HashMap<>();\n        for (String kv : kvs) {\n            String[] p = kv.split(\"=\");\n            if (p.length == 2) map.put(p[0].trim(), p[1].trim());\n        }\n        String color = map.getOrDefault(\"color\", \"black\");\n\n        switch (type.toLowerCase()) {\n            case \"rectangle\":\n                return new Rectangle(\n                    Double.parseDouble(map.getOrDefault(\"width\", \"0\")),\n                    Double.parseDouble(map.getOrDefault(\"height\", \"0\")),\n                    color\n                );\n            case \"circle\":\n                return new Circle(\n                    Double.parseDouble(map.getOrDefault(\"radius\", \"0\")),\n                    color\n                );\n            case \"cube\":\n                return new Cube(\n                    Double.parseDouble(map.getOrDefault(\"edge\", \"0\")),\n                    color\n                );\n            default:\n                throw new IllegalArgumentException(\"Unknown shape: \" + type);\n        }\n    }\n}",
      "output": "abstract class GraphicObject {\n    private final String color;\n\n    protected GraphicObject(String color) {\n        this.color = color;\n    }\n\n    public String getColor() {\n        return color;\n    }\n}\n\nabstract class Shape extends GraphicObject {\n    protected Shape(String color) {\n        super(color);\n    }\n\n    public abstract double area();\n    public abstract double perimeter();\n    public abstract double volume();\n    public abstract String toJson();\n}\n\nabstract class TwoDShape extends Shape {\n    protected TwoDShape(String color) {\n        super(color);\n    }\n\n    @Override\n    public double volume() {\n        return 0;\n    }\n}\n\nabstract class ThreeDShape extends Shape {\n    protected ThreeDShape(String color) {\n        super(color);\n    }\n}\n\nclass Rectangle extends TwoDShape {\n    private final double width;\n    private final double height;\n\n    public Rectangle(double width, double height, String color) {\n        super(color);\n        this.width = width;\n        this.height = height;\n    }\n\n    public double getWidth() { return width; }\n    public double getHeight() { return height; }\n\n    @Override\n    public double area() {\n        return width * height;\n    }\n\n    @Override\n    public double perimeter() {\n        return 2 * (width + height);\n    }\n\n    @Override\n    public String toJson() {\n        return String.format(\n            \"{\\\"type\\\":\\\"rectangle\\\",\\\"color\\\":\\\"%s\\\",\\\"width\\\":%.2f,\\\"height\\\":%.2f}\",\n            getColor(), width, height\n        );\n    }\n}\n\nclass Circle extends TwoDShape {\n    private final double radius;\n\n    public Circle(double radius, String color) {\n        super(color);\n        this.radius = radius;\n    }\n\n    public double getRadius() { return radius; }\n\n    @Override\n    public double area() {\n        return Math.PI * radius * radius;\n    }\n\n    @Override\n    public double perimeter() {\n        return 2 * Math.PI * radius;\n    }\n\n    @Override\n    public String toJson() {\n        return String.format(\n            \"{\\\"type\\\":\\\"circle\\\",\\\"color\\\":\\\"%s\\\",\\\"radius\\\":%.2f}\",\n            getColor(), radius\n        );\n    }\n}\n\nclass Cube extends ThreeDShape {\n    private final double edge;\n\n    public Cube(double edge, String color) {\n        super(color);\n        this.edge = edge;\n    }\n\n    public double getEdge() { return edge; }\n\n    @Override\n    public double area() {\n        return 6 * edge * edge;\n    }\n\n    @Override\n    public double perimeter() {\n        return 12 * edge;\n    }\n\n    @Override\n    public double volume() {\n        return Math.pow(edge, 3);\n    }\n\n    @Override\n    public String toJson() {\n        return String.format(\n            \"{\\\"type\\\":\\\"cube\\\",\\\"color\\\":\\\"%s\\\",\\\"edge\\\":%.2f}\",\n            getColor(), edge\n        );\n    }\n}\n\nenum Metric { AREA, PERIMETER, VOLUME }\n\nclass MetricCalculator {\n    public double compute(Shape shape, Metric metric) {\n        return switch (metric) {\n            case AREA -> shape.area();\n            case PERIMETER -> shape.perimeter();\n            case VOLUME -> shape.volume();\n        };\n    }\n}\n\nclass ShapeExporter {\n    public String toJson(Shape shape) {\n        return shape.toJson();\n    }\n}\n\nclass ShapeFactory {\n    public Shape create(String spec) {\n        String[] parts = spec.split(\":\", 2);\n        String type = parts[0].trim();\n        String[] kvs = (parts.length > 1 ? parts[1] : \"\").split(\";\");\n        java.util.Map<String, String> map = new java.util.HashMap<>();\n        for (String kv : kvs) {\n            String[] p = kv.split(\"=\");\n            if (p.length == 2) map.put(p[0].trim(), p[1].trim());\n        }\n        String color = map.getOrDefault(\"color\", \"black\");\n\n        return switch (type.toLowerCase()) {\n            case \"rectangle\" -> new Rectangle(\n                Double.parseDouble(map.getOrDefault(\"width\", \"0\")),\n                Double.parseDouble(map.getOrDefault(\"height\", \"0\")),\n                color\n            );\n            case \"circle\" -> new Circle(\n                Double.parseDouble(map.getOrDefault(\"radius\", \"0\")),\n                color\n            );\n            case \"cube\" -> new Cube(\n                Double.parseDouble(map.getOrDefault(\"edge\", \"0\")),\n                color\n            );\n            default -> throw new IllegalArgumentException(\"Unknown shape: \" + type);\n        };\n    }\n}\n",
      "level": "MODERATE",
      "language": "JAVA",
      "violation": "OCP"
    },
    {
      "input": "import java.util.*;\n\nenum CharacterType {\n    WARRIOR,\n    MAGE,\n    ARCHER\n}\n\nenum SkillType {\n    BASIC,\n    SPECIAL\n}\n\nclass GameCharacter {\n    private final String name;\n    private final CharacterType type;\n    private final int baseAttack;\n    private final int level;\n\n    public GameCharacter(String name, CharacterType type, int baseAttack, int level) {\n        this.name = name;\n        this.type = type;\n        this.baseAttack = baseAttack;\n        this.level = level;\n    }\n\n    public String getName() { return name; }\n    public CharacterType getType() { return type; }\n    public int getBaseAttack() { return baseAttack; }\n    public int getLevel() { return level; }\n}\n\nclass Skill {\n    private final SkillType type;\n    private final String name;\n\n    public Skill(SkillType type, String name) {\n        this.type = type;\n        this.name = name;\n    }\n\n    public SkillType getType() { return type; }\n    public String getName() { return name; }\n}\n\nclass Enemy {\n    private final String name;\n    private final int armor;\n    private final int resistance;\n\n    public Enemy(String name, int armor, int resistance) {\n        this.name = name;\n        this.armor = armor;\n        this.resistance = resistance;\n    }\n\n    public String getName() { return name; }\n    public int getArmor() { return armor; }\n    public int getResistance() { return resistance; }\n}\n\nclass DamageCalculator {\n    private final Random rng = new Random();\n\n    public int calculateDamage(GameCharacter c, Skill s, Enemy e) {\n        int raw;\n        switch (c.getType()) {\n            case WARRIOR:\n                raw = (int) (c.getBaseAttack() * (1.2 + c.getLevel() * 0.05));\n                if (s.getType() == SkillType.SPECIAL) raw *= 1.5;\n                raw -= e.getArmor();\n                return Math.max(raw, 0);\n            case MAGE:\n                raw = c.getBaseAttack() + (int) (c.getLevel() * 3.5);\n                if (s.getType() == SkillType.SPECIAL) raw += 25;\n                raw -= e.getResistance();\n                return Math.max(raw, 0);\n            case ARCHER:\n                raw = c.getBaseAttack();\n                boolean crit = rng.nextInt(100) < (20 + c.getLevel());\n                if (crit) raw *= 2;\n                if (s.getType() == SkillType.SPECIAL) raw += 10;\n                raw -= (int) (e.getArmor() * 0.5);\n                return Math.max(raw, 0);\n            default:\n                throw new IllegalArgumentException(\"Unknown type\");\n        }\n    }\n}\n\nclass LootCalculator {\n    public int calculateGold(GameCharacter c, Enemy e) {\n        switch (c.getType()) {\n            case WARRIOR:\n                return 10 + c.getLevel() + e.getArmor() / 5;\n            case MAGE:\n                return 8 + c.getLevel() * 2 + e.getResistance() / 4;\n            case ARCHER:\n                return 9 + (int) Math.round(c.getLevel() * 1.5);\n            default:\n                throw new IllegalArgumentException(\"Unknown type\");\n        }\n    }\n}\n",
      "output": "import java.util.*;\n\nenum SkillType {\n    BASIC,\n    SPECIAL\n}\n\nclass Skill {\n    private final SkillType type;\n    private final String name;\n\n    public Skill(SkillType type, String name) {\n        this.type = type;\n        this.name = name;\n    }\n\n    public SkillType getType() { return type; }\n    public String getName() { return name; }\n}\n\nclass Enemy {\n    private final String name;\n    private final int armor;\n    private final int resistance;\n\n    public Enemy(String name, int armor, int resistance) {\n        this.name = name;\n        this.armor = armor;\n        this.resistance = resistance;\n    }\n\n    public String getName() { return name; }\n    public int getArmor() { return armor; }\n    public int getResistance() { return resistance; }\n}\n\nabstract class GameCharacter {\n    private final String name;\n    private final int baseAttack;\n    private final int level;\n\n    protected GameCharacter(String name, int baseAttack, int level) {\n        this.name = name;\n        this.baseAttack = baseAttack;\n        this.level = level;\n    }\n\n    public String getName() { return name; }\n    public int getBaseAttack() { return baseAttack; }\n    public int getLevel() { return level; }\n\n    public abstract int calculateDamage(Skill s, Enemy e, Random rng);\n    public abstract int calculateGold(Enemy e);\n}\n\nclass Warrior extends GameCharacter {\n    public Warrior(String name, int baseAttack, int level) {\n        super(name, baseAttack, level);\n    }\n\n    @Override\n    public int calculateDamage(Skill s, Enemy e, Random rng) {\n        int raw = (int) (getBaseAttack() * (1.2 + getLevel() * 0.05));\n        if (s.getType() == SkillType.SPECIAL) raw *= 1.5;\n        raw -= e.getArmor();\n        return Math.max(raw, 0);\n    }\n\n    @Override\n    public int calculateGold(Enemy e) {\n        return 10 + getLevel() + e.getArmor() / 5;\n    }\n}\n\nclass Mage extends GameCharacter {\n    public Mage(String name, int baseAttack, int level) {\n        super(name, baseAttack, level);\n    }\n\n    @Override\n    public int calculateDamage(Skill s, Enemy e, Random rng) {\n        int raw = getBaseAttack() + (int) (getLevel() * 3.5);\n        if (s.getType() == SkillType.SPECIAL) raw += 25;\n        raw -= e.getResistance();\n        return Math.max(raw, 0);\n    }\n\n    @Override\n    public int calculateGold(Enemy e) {\n        return 8 + getLevel() * 2 + e.getResistance() / 4;\n    }\n}\n\nclass Archer extends GameCharacter {\n    public Archer(String name, int baseAttack, int level) {\n        super(name, baseAttack, level);\n    }\n\n    @Override\n    public int calculateDamage(Skill s, Enemy e, Random rng) {\n        int raw = getBaseAttack();\n        boolean crit = rng.nextInt(100) < (20 + getLevel());\n        if (crit) raw *= 2;\n        if (s.getType() == SkillType.SPECIAL) raw += 10;\n        raw -= (int) (e.getArmor() * 0.5);\n        return Math.max(raw, 0);\n    }\n\n    @Override\n    public int calculateGold(Enemy e) {\n        return 9 + (int) Math.round(getLevel() * 1.5);\n    }\n}\n",
      "level": "MODERATE",
      "language": "JAVA",
      "violation": "OCP"
    },
    {
      "input": "import java.util.*;\n\nenum FoodType { BURGER, FRIES, PIZZA, DRINK, SALAD, DESSERT }\nenum Size { SMALL, MEDIUM, LARGE }\n\nclass FoodItem {\n    private final String name;\n    private final FoodType type;\n    private final Size size;\n    private final Set<String> extras;\n\n    public FoodItem(String name, FoodType type, Size size, Set<String> extras) {\n        this.name = name; this.type = type; this.size = size; this.extras = extras == null ? new HashSet<>() : extras;\n    }\n    public String getName() { return name; }\n    public FoodType getType() { return type; }\n    public Size getSize() { return size; }\n    public Set<String> getExtras() { return extras; }\n}\n\nclass Order {\n    private final String customer;\n    private final List<FoodItem> items = new ArrayList<>();\n    public Order(String customer) { this.customer = customer; }\n    public void add(FoodItem item) { items.add(item); }\n    public List<FoodItem> items() { return items; }\n    public String customer() { return customer; }\n}\n\nclass PriceCalculator {\n    public double price(FoodItem item) {\n        switch (item.getType()) {\n            case BURGER:\n                switch (item.getSize()) {\n                    case SMALL: return 5.49;\n                    case MEDIUM: return 6.49;\n                    default: return 7.49;\n                }\n            case FRIES:\n                switch (item.getSize()) {\n                    case SMALL: return 1.99;\n                    case MEDIUM: return 2.49;\n                    default: return 2.99;\n                }\n            case PIZZA:\n                switch (item.getSize()) {\n                    case SMALL: return 7.99;\n                    case MEDIUM: return 9.99;\n                    default: return 12.49;\n                }\n            case DRINK:\n                switch (item.getSize()) {\n                    case SMALL: return 1.29;\n                    case MEDIUM: return 1.49;\n                    default: return 1.79;\n                }\n            case SALAD:\n                switch (item.getSize()) {\n                    case SMALL: return 4.49;\n                    case MEDIUM: return 5.49;\n                    default: return 6.49;\n                }\n            case DESSERT:\n                switch (item.getSize()) {\n                    case SMALL: return 2.99;\n                    case MEDIUM: return 3.49;\n                    default: return 3.99;\n                }\n            default:\n                throw new IllegalArgumentException(\"Unknown type\");\n        }\n    }\n}\n\nclass TaxCalculator {\n    public double taxFor(FoodItem item) {\n        switch (item.getType()) {\n            case DRINK: return 0.10;\n            case DESSERT: return 0.08;\n            case PIZZA: return 0.06;\n            default: return 0.05;\n        }\n    }\n}\n\nclass NutritionCalculator {\n    public int calories(FoodItem item) {\n        switch (item.getType()) {\n            case BURGER:\n                switch (item.getSize()) {\n                    case SMALL: return 480;\n                    case MEDIUM: return 650;\n                    default: return 820;\n                }\n            case FRIES:\n                switch (item.getSize()) {\n                    case SMALL: return 220;\n                    case MEDIUM: return 330;\n                    default: return 440;\n                }\n            case PIZZA:\n                switch (item.getSize()) {\n                    case SMALL: return 700;\n                    case MEDIUM: return 950;\n                    default: return 1200;\n                }\n            case DRINK:\n                switch (item.getSize()) {\n                    case SMALL: return 110;\n                    case MEDIUM: return 160;\n                    default: return 210;\n                }\n            case SALAD:\n                switch (item.getSize()) {\n                    case SMALL: return 180;\n                    case MEDIUM: return 260;\n                    default: return 340;\n                }\n            case DESSERT:\n                switch (item.getSize()) {\n                    case SMALL: return 250;\n                    case MEDIUM: return 320;\n                    default: return 390;\n                }\n            default:\n                return 0;\n        }\n    }\n}\n\nclass PromotionEngine {\n    public double discount(FoodItem item) {\n        switch (item.getType()) {\n            case BURGER: return item.getExtras().contains(\"extra-cheese\") ? 0.50 : 0.0;\n            case FRIES: return item.getSize() == Size.LARGE ? 0.20 : 0.0;\n            case DRINK: return item.getExtras().contains(\"no-ice\") ? 0.10 : 0.0;\n            case SALAD: return item.getExtras().contains(\"chicken\") ? 0.30 : 0.0;\n            case PIZZA: return item.getExtras().contains(\"pepperoni\") ? 0.40 : 0.0;\n            case DESSERT: return 0.0;\n            default: return 0.0;\n        }\n    }\n}\n\nclass KitchenStationRouter {\n    public String station(FoodItem item) {\n        switch (item.getType()) {\n            case BURGER: return \"Grill\";\n            case FRIES: return \"Fryer\";\n            case PIZZA: return \"Oven\";\n            case DRINK: return \"Beverage\";\n            case SALAD: return \"Cold Prep\";\n            case DESSERT: return \"Dessert Bar\";\n            default: return \"Unknown\";\n        }\n    }\n}\n\nclass InventoryManager {\n    private final Map<String, Integer> stock = new HashMap<>();\n    public InventoryManager() {\n        stock.put(\"bun\", 50); stock.put(\"patty\", 50); stock.put(\"potato\", 80);\n        stock.put(\"dough\", 30); stock.put(\"soda\", 100); stock.put(\"greens\", 40); stock.put(\"dessertBase\", 30);\n    }\n    public boolean reserve(FoodItem item) {\n        switch (item.getType()) {\n            case BURGER:\n                return take(\"bun\",1) && take(\"patty\",1);\n            case FRIES:\n                return take(\"potato\",2);\n            case PIZZA:\n                return take(\"dough\",1);\n            case DRINK:\n                return take(\"soda\",1);\n            case SALAD:\n                return take(\"greens\",1);\n            case DESSERT:\n                return take(\"dessertBase\",1);\n            default:\n                return false;\n        }\n    }\n    private boolean take(String key, int qty) {\n        int have = stock.getOrDefault(key,0);\n        if (have < qty) return false;\n        stock.put(key, have - qty);\n        return true;\n    }\n    public Map<String,Integer> getStock(){ return Collections.unmodifiableMap(stock); }\n}\n\nclass Chef {\n    public void prepare(FoodItem item) {\n        switch (item.getType()) {\n            case BURGER:\n                System.out.println(\"Chef grills patty and assembles burger\");\n                break;\n            case FRIES:\n                System.out.println(\"Chef drops fries in fryer\");\n                break;\n            case PIZZA:\n                System.out.println(\"Chef stretches dough and bakes pizza\");\n                break;\n            case DRINK:\n                System.out.println(\"Chef fills cup and lids drink\");\n                break;\n            case SALAD:\n                System.out.println(\"Chef chops and tosses salad\");\n                break;\n            case DESSERT:\n                System.out.println(\"Chef plates dessert\");\n                break;\n        }\n    }\n}\n\nclass Waiter {\n    public void take(Order order, FoodItem item) {\n        System.out.println(\"Waiter records item: \" + item.getName());\n        order.add(item);\n    }\n    public void serve(FoodItem item) {\n        switch (item.getType()) {\n            case BURGER:\n                System.out.println(\"Waiter serves burger with napkins\");\n                break;\n            case FRIES:\n                System.out.println(\"Waiter serves fries with ketchup\");\n                break;\n            case PIZZA:\n                System.out.println(\"Waiter serves pizza with slicer\");\n                break;\n            case DRINK:\n                System.out.println(\"Waiter serves drink with straw\");\n                break;\n            case SALAD:\n                System.out.println(\"Waiter serves salad with dressing\");\n                break;\n            case DESSERT:\n                System.out.println(\"Waiter serves dessert with spoon\");\n                break;\n        }\n    }\n}\n\nclass Cashier {\n    private final PriceCalculator prices = new PriceCalculator();\n    private final TaxCalculator taxes = new TaxCalculator();\n    private final PromotionEngine promos = new PromotionEngine();\n\n    public double total(Order order) {\n        double sum = 0.0;\n        for (FoodItem item : order.items()) {\n            double base = prices.price(item);\n            double discount = promos.discount(item);\n            double taxed = (base - discount) * (1.0 + taxes.taxFor(item));\n            sum += taxed;\n        }\n        return Math.round(sum * 100.0) / 100.0;\n    }\n}\n\nclass ReceiptPrinter {\n    private final PriceCalculator prices = new PriceCalculator();\n    private final TaxCalculator taxes = new TaxCalculator();\n    private final PromotionEngine promos = new PromotionEngine();\n    private final NutritionCalculator nutrition = new NutritionCalculator();\n\n    public void print(Order order) {\n        System.out.println(\"Customer: \" + order.customer());\n        for (FoodItem item : order.items()) {\n            double base = prices.price(item);\n            double discount = promos.discount(item);\n            double taxRate = taxes.taxFor(item);\n            int kcal = nutrition.calories(item);\n            System.out.println(item.getName() + \" (\" + item.getType() + \" \" + item.getSize() + \") \"\n                    + \"base $\" + base + \" disc $\" + discount + \" tax \" + (int)(taxRate*100) + \"% kcal \" + kcal);\n        }\n    }\n}\n",
      "output": "import java.util.*;\n\nenum FoodType { BURGER, FRIES, PIZZA, DRINK, SALAD, DESSERT }\nenum Size { SMALL, MEDIUM, LARGE }\n\nclass FoodItem {\n    private final String name;\n    private final FoodType type;\n    private final Size size;\n    private final Set<String> extras;\n\n    public FoodItem(String name, FoodType type, Size size, Set<String> extras) {\n        this.name = name; this.type = type; this.size = size; this.extras = extras == null ? new HashSet<>() : extras;\n    }\n    public String getName() { return name; }\n    public FoodType getType() { return type; }\n    public Size getSize() { return size; }\n    public Set<String> getExtras() { return extras; }\n}\n\nclass Order {\n    private final String customer;\n    private final List<FoodItem> items = new ArrayList<>();\n    public Order(String customer) { this.customer = customer; }\n    public void add(FoodItem item) { items.add(item); }\n    public List<FoodItem> items() { return items; }\n    public String customer() { return customer; }\n}\n\ninterface FoodOps {\n    FoodType type();\n    double tax();\n    double discount(FoodItem item);\n    String station();\n    void prepare();\n    void serve();\n    boolean reserve(InventoryManager inventory, FoodItem item);\n}\n\nclass FoodOpsRegistry {\n    private static final Map<FoodType, FoodOps> OPS = new EnumMap<>(FoodType.class);\n    static void register(FoodOps ops) { OPS.put(ops.type(), ops); }\n    static FoodOps of(FoodType t) {\n        FoodOps o = OPS.get(t);\n        if (o == null) throw new IllegalArgumentException(\"Unknown type\");\n        return o;\n    }\n    static {\n        register(new BurgerOps());\n        register(new FriesOps());\n        register(new PizzaOps());\n        register(new DrinkOps());\n        register(new SaladOps());\n        register(new DessertOps());\n    }\n}\n\nclass BurgerOps implements FoodOps {\n    public FoodType type() { return FoodType.BURGER; }\n    public double tax() { return 0.05; }\n    public double discount(FoodItem item) { return item.getExtras().contains(\"extra-cheese\")?0.50:0.0; }\n    public String station() { return \"Grill\"; }\n    public void prepare() { System.out.println(\"Chef grills patty and assembles burger\"); }\n    public void serve() { System.out.println(\"Waiter serves burger with napkins\"); }\n    public boolean reserve(InventoryManager inv, FoodItem i) { return inv.consume(\"bun\",1) && inv.consume(\"patty\",1); }\n}\nclass FriesOps implements FoodOps {\n    public FoodType type() { return FoodType.FRIES; }\n    public double tax() { return 0.05; }\n    public double discount(FoodItem item) { return item.getSize()==Size.LARGE?0.20:0.0; }\n    public String station() { return \"Fryer\"; }\n    public void prepare() { System.out.println(\"Chef drops fries in fryer\"); }\n    public void serve() { System.out.println(\"Waiter serves fries with ketchup\"); }\n    public boolean reserve(InventoryManager inv, FoodItem i) { return inv.consume(\"potato\",2); }\n}\nclass PizzaOps implements FoodOps {\n    public FoodType type() { return FoodType.PIZZA; }\n    public double tax() { return 0.06; }\n    public double discount(FoodItem item) { return item.getExtras().contains(\"pepperoni\")?0.40:0.0; }\n    public String station() { return \"Oven\"; }\n    public void prepare() { System.out.println(\"Chef stretches dough and bakes pizza\"); }\n    public void serve() { System.out.println(\"Waiter serves pizza with slicer\"); }\n    public boolean reserve(InventoryManager inv, FoodItem i) { return inv.consume(\"dough\",1); }\n}\nclass DrinkOps implements FoodOps {\n    public FoodType type() { return FoodType.DRINK; }\n    public double tax() { return 0.10; }\n    public double discount(FoodItem item) { return item.getExtras().contains(\"no-ice\")?0.10:0.0; }\n    public String station() { return \"Beverage\"; }\n    public void prepare() { System.out.println(\"Chef fills cup and lids drink\"); }\n    public void serve() { System.out.println(\"Waiter serves drink with straw\"); }\n    public boolean reserve(InventoryManager inv, FoodItem i) { return inv.consume(\"soda\",1); }\n}\nclass SaladOps implements FoodOps {\n    public FoodType type() { return FoodType.SALAD; }\n    public double tax() { return 0.05; }\n    public double discount(FoodItem item) { return item.getExtras().contains(\"chicken\")?0.30:0.0; }\n    public String station() { return \"Cold Prep\"; }\n    public void prepare() { System.out.println(\"Chef chops and tosses salad\"); }\n    public void serve() { System.out.println(\"Waiter serves salad with dressing\"); }\n    public boolean reserve(InventoryManager inv, FoodItem i) { return inv.consume(\"greens\",1); }\n}\nclass DessertOps implements FoodOps {\n    public FoodType type() { return FoodType.DESSERT; }\n    public double tax() { return 0.08; }\n    public double discount(FoodItem item) { return 0.0; }\n    public String station() { return \"Dessert Bar\"; }\n    public void prepare() { System.out.println(\"Chef plates dessert\"); }\n    public void serve() { System.out.println(\"Waiter serves dessert with spoon\"); }\n    public boolean reserve(InventoryManager inv, FoodItem i) { return inv.consume(\"dessertBase\",1); }\n}\n\nclass PriceTable {\n    private static final Map<FoodType, EnumMap<Size, Double>> PRICES = new EnumMap<>(FoodType.class);\n    static {\n        PRICES.put(FoodType.BURGER, map(5.49,6.49,7.49));\n        PRICES.put(FoodType.FRIES, map(1.99,2.49,2.99));\n        PRICES.put(FoodType.PIZZA, map(7.99,9.99,12.49));\n        PRICES.put(FoodType.DRINK, map(1.29,1.49,1.79));\n        PRICES.put(FoodType.SALAD, map(4.49,5.49,6.49));\n        PRICES.put(FoodType.DESSERT, map(2.99,3.49,3.99));\n    }\n    private static EnumMap<Size, Double> map(double s, double m, double l){\n        EnumMap<Size, Double> mapp = new EnumMap<>(Size.class);\n        mapp.put(Size.SMALL, s); mapp.put(Size.MEDIUM, m); mapp.put(Size.LARGE, l);\n        return mapp;\n    }\n    static double get(FoodItem item){\n        EnumMap<Size, Double> m = PRICES.get(item.getType());\n        if (m == null || !m.containsKey(item.getSize())) throw new IllegalArgumentException(\"Missing price\");\n        return m.get(item.getSize());\n    }\n}\n\nclass CalorieTable {\n    private static final Map<FoodType, EnumMap<Size, Integer>> CALS = new EnumMap<>(FoodType.class);\n    static {\n        CALS.put(FoodType.BURGER, map(480,650,820));\n        CALS.put(FoodType.FRIES, map(220,330,440));\n        CALS.put(FoodType.PIZZA, map(700,950,1200));\n        CALS.put(FoodType.DRINK, map(110,160,210));\n        CALS.put(FoodType.SALAD, map(180,260,340));\n        CALS.put(FoodType.DESSERT, map(250,320,390));\n    }\n    private static EnumMap<Size, Integer> map(int s, int m, int l){\n        EnumMap<Size, Integer> mapp = new EnumMap<>(Size.class);\n        mapp.put(Size.SMALL, s); mapp.put(Size.MEDIUM, m); mapp.put(Size.LARGE, l);\n        return mapp;\n    }\n    static int get(FoodItem item){\n        EnumMap<Size, Integer> m = CALS.get(item.getType());\n        if (m == null || !m.containsKey(item.getSize())) return 0;\n        return m.get(item.getSize());\n    }\n}\n\nclass PriceCalculator {\n    public double price(FoodItem item) { return PriceTable.get(item); }\n}\n\nclass TaxCalculator {\n    public double taxFor(FoodItem item) { return FoodOpsRegistry.of(item.getType()).tax(); }\n}\n\nclass NutritionCalculator {\n    public int calories(FoodItem item) { return CalorieTable.get(item); }\n}\n\nclass PromotionEngine {\n    public double discount(FoodItem item) { return FoodOpsRegistry.of(item.getType()).discount(item); }\n}\n\nclass KitchenStationRouter {\n    public String station(FoodItem item) { return FoodOpsRegistry.of(item.getType()).station(); }\n}\n\nclass InventoryManager {\n    private final Map<String, Integer> stock = new HashMap<>();\n    public InventoryManager() {\n        stock.put(\"bun\", 50); stock.put(\"patty\", 50); stock.put(\"potato\", 80);\n        stock.put(\"dough\", 30); stock.put(\"soda\", 100); stock.put(\"greens\", 40); stock.put(\"dessertBase\", 30);\n    }\n    public boolean reserve(FoodItem item) { return FoodOpsRegistry.of(item.getType()).reserve(this, item); }\n    public boolean consume(String key, int qty) { return take(key, qty); }\n    private boolean take(String key, int qty) {\n        int have = stock.getOrDefault(key,0);\n        if (have < qty) return false;\n        stock.put(key, have - qty);\n        return true;\n    }\n    public Map<String,Integer> getStock(){ return Collections.unmodifiableMap(stock); }\n}\n\nclass Chef {\n    public void prepare(FoodItem item) { FoodOpsRegistry.of(item.getType()).prepare(); }\n}\n\nclass Waiter {\n    public void take(Order order, FoodItem item) {\n        System.out.println(\"Waiter records item: \" + item.getName());\n        order.add(item);\n    }\n    public void serve(FoodItem item) { FoodOpsRegistry.of(item.getType()).serve(); }\n}\n\nclass Cashier {\n    private final PriceCalculator prices = new PriceCalculator();\n    private final TaxCalculator taxes = new TaxCalculator();\n    private final PromotionEngine promos = new PromotionEngine();\n\n    public double total(Order order) {\n        double sum = 0.0;\n        for (FoodItem item : order.items()) {\n            double base = prices.price(item);\n            double discount = promos.discount(item);\n            double taxed = (base - discount) * (1.0 + taxes.taxFor(item));\n            sum += taxed;\n        }\n        return Math.round(sum * 100.0) / 100.0;\n    }\n}\n\nclass ReceiptPrinter {\n    private final PriceCalculator prices = new PriceCalculator();\n    private final TaxCalculator taxes = new TaxCalculator();\n    private final PromotionEngine promos = new PromotionEngine();\n    private final NutritionCalculator nutrition = new NutritionCalculator();\n\n    public void print(Order order) {\n        System.out.println(\"Customer: \" + order.customer());\n        for (FoodItem item : order.items()) {\n            double base = prices.price(item);\n            double discount = promos.discount(item);\n            double taxRate = taxes.taxFor(item);\n            int kcal = nutrition.calories(item);\n            System.out.println(item.getName() + \" (\" + item.getType() + \" \" + item.getSize() + \") \"\n                    + \"base $\" + base + \" disc $\" + discount + \" tax \" + (int)(taxRate*100) + \"% kcal \" + kcal);\n        }\n    }\n}\n",
      "level": "MODERATE",
      "language": "JAVA",
      "violation": "OCP"
    },
    {
      "input": "import java.util.*;\n\nenum DeviceType { LIGHT, THERMOSTAT, DOOR_LOCK, CAMERA, SPRINKLER }\nenum RoomType { LIVING, KITCHEN, BEDROOM, GARDEN }\nenum Mode { ECO, COMFORT, AWAY, NIGHT }\n\nclass SmartDevice {\n    private final String id;\n    private final DeviceType type;\n    private Mode mode = Mode.ECO;\n    private boolean online = true;\n\n    public SmartDevice(String id, DeviceType type) {\n        this.id = id; this.type = type;\n    }\n    public String getId() { return id; }\n    public DeviceType getType() { return type; }\n    public Mode getMode() { return mode; }\n    public boolean isOnline() { return online; }\n    public void setMode(Mode m) { this.mode = m; }\n    public void setOnline(boolean o) { this.online = o; }\n}\n\nclass Room {\n    private final String name;\n    private final RoomType type;\n    private final List<SmartDevice> devices = new ArrayList<>();\n    public Room(String name, RoomType type) { this.name = name; this.type = type; }\n    public void add(SmartDevice d) { devices.add(d); }\n    public List<SmartDevice> getDevices() { return devices; }\n    public String getName() { return name; }\n    public RoomType getType() { return type; }\n}\n\nclass ScheduleEntry {\n    public final SmartDevice device;\n    public final String cron;\n    public final String action;\n    public ScheduleEntry(SmartDevice device, String cron, String action) {\n        this.device = device; this.cron = cron; this.action = action;\n    }\n}\n\nclass SmartHomeController {\n    public void turnOn(SmartDevice d) {\n        switch (d.getType()) {\n            case LIGHT: System.out.println(\"Light \" + d.getId() + \" ON\"); break;\n            case THERMOSTAT: System.out.println(\"Thermostat \" + d.getId() + \" heating\"); break;\n            case DOOR_LOCK: System.out.println(\"Lock \" + d.getId() + \" stays locked\"); break;\n            case CAMERA: System.out.println(\"Camera \" + d.getId() + \" recording\"); break;\n            case SPRINKLER: System.out.println(\"Sprinkler \" + d.getId() + \" watering\"); break;\n        }\n    }\n    public void turnOff(SmartDevice d) {\n        switch (d.getType()) {\n            case LIGHT: System.out.println(\"Light \" + d.getId() + \" OFF\"); break;\n            case THERMOSTAT: System.out.println(\"Thermostat \" + d.getId() + \" idle\"); break;\n            case DOOR_LOCK: System.out.println(\"Lock \" + d.getId() + \" remains locked\"); break;\n            case CAMERA: System.out.println(\"Camera \" + d.getId() + \" standby\"); break;\n            case SPRINKLER: System.out.println(\"Sprinkler \" + d.getId() + \" stopped\"); break;\n        }\n    }\n    public void setMode(SmartDevice d, Mode m) {\n        d.setMode(m);\n        switch (d.getType()) {\n            case LIGHT: System.out.println(\"Light \" + d.getId() + \" mode \" + m); break;\n            case THERMOSTAT: System.out.println(\"Thermostat \" + d.getId() + \" mode \" + m); break;\n            case DOOR_LOCK: System.out.println(\"Lock \" + d.getId() + \" mode \" + m); break;\n            case CAMERA: System.out.println(\"Camera \" + d.getId() + \" mode \" + m); break;\n            case SPRINKLER: System.out.println(\"Sprinkler \" + d.getId() + \" mode \" + m); break;\n        }\n    }\n    public double energyUsageKwh(SmartDevice d, int minutes) {\n        switch (d.getType()) {\n            case LIGHT: return 0.012 * minutes;\n            case THERMOSTAT: return 0.08 * minutes;\n            case DOOR_LOCK: return 0.0002 * minutes;\n            case CAMERA: return 0.01 * minutes;\n            case SPRINKLER: return 0.03 * minutes;\n            default: return 0;\n        }\n    }\n    public String deviceIcon(SmartDevice d) {\n        switch (d.getType()) {\n            case LIGHT: return \"\";\n            case THERMOSTAT: return \"\";\n            case DOOR_LOCK: return \"\";\n            case CAMERA: return \"\";\n            case SPRINKLER: return \"\";\n            default: return \"\";\n        }\n    }\n    public List<String> firmwareUpdateSteps(SmartDevice d) {\n        switch (d.getType()) {\n            case LIGHT: return Arrays.asList(\"Ping\", \"Push FW\", \"Reboot\");\n            case THERMOSTAT: return Arrays.asList(\"Ping\", \"Backup Profile\", \"Push FW\", \"Recalibrate\");\n            case DOOR_LOCK: return Arrays.asList(\"Ping\", \"Secure Channel\", \"Push FW\", \"Reauth\");\n            case CAMERA: return Arrays.asList(\"Ping\", \"Push FW\", \"Restart Stream\");\n            case SPRINKLER: return Arrays.asList(\"Ping\", \"Push FW\", \"Valve Test\");\n            default: return Collections.emptyList();\n        }\n    }\n}\n\nclass NotificationService {\n    public void notifyOwner(SmartDevice d, String event) {\n        switch (d.getType()) {\n            case LIGHT: System.out.println(\"Notify: Light \" + d.getId() + \" -> \" + event); break;\n            case THERMOSTAT: System.out.println(\"Notify: Thermostat \" + d.getId() + \" -> \" + event); break;\n            case DOOR_LOCK: System.out.println(\"Notify: Lock \" + d.getId() + \" -> \" + event); break;\n            case CAMERA: System.out.println(\"Notify: Camera \" + d.getId() + \" -> \" + event); break;\n            case SPRINKLER: System.out.println(\"Notify: Sprinkler \" + d.getId() + \" -> \" + event); break;\n        }\n    }\n}\n\nclass DiagnosticsService {\n    public String health(SmartDevice d) {\n        switch (d.getType()) {\n            case LIGHT: return d.isOnline() ? \"OK\" : \"Bulb Offline\";\n            case THERMOSTAT: return d.isOnline() ? \"OK\" : \"Sensor Offline\";\n            case DOOR_LOCK: return d.isOnline() ? \"OK\" : \"Battery Low\";\n            case CAMERA: return d.isOnline() ? \"OK\" : \"Stream Error\";\n            case SPRINKLER: return d.isOnline() ? \"OK\" : \"Valve Error\";\n            default: return \"Unknown\";\n        }\n    }\n    public double maintenanceCostYearly(SmartDevice d) {\n        switch (d.getType()) {\n            case LIGHT: return 5.0;\n            case THERMOSTAT: return 20.0;\n            case DOOR_LOCK: return 12.0;\n            case CAMERA: return 18.0;\n            case SPRINKLER: return 15.0;\n            default: return 0.0;\n        }\n    }\n}\n\nclass SecurityPolicy {\n    public boolean actionAllowed(SmartDevice d, String action, boolean userHome) {\n        switch (d.getType()) {\n            case DOOR_LOCK: return action.equals(\"unlock\") ? userHome : true;\n            case CAMERA: return action.equals(\"record\") ? true : true;\n            case THERMOSTAT: return true;\n            case LIGHT: return true;\n            case SPRINKLER: return !action.equals(\"on\") || !userHome;\n            default: return false;\n        }\n    }\n}\n\nclass VoiceCommandProcessor {\n    private final SmartHomeController ctl = new SmartHomeController();\n    public void handle(String phrase, SmartDevice d) {\n        switch (d.getType()) {\n            case LIGHT:\n                if (phrase.equalsIgnoreCase(\"lights on\")) ctl.turnOn(d);\n                else if (phrase.equalsIgnoreCase(\"lights off\")) ctl.turnOff(d);\n                else if (phrase.equalsIgnoreCase(\"night mode\")) ctl.setMode(d, Mode.NIGHT);\n                break;\n            case THERMOSTAT:\n                if (phrase.equalsIgnoreCase(\"heat on\")) ctl.turnOn(d);\n                else if (phrase.equalsIgnoreCase(\"eco mode\")) ctl.setMode(d, Mode.ECO);\n                break;\n            case DOOR_LOCK:\n                if (phrase.equalsIgnoreCase(\"lock door\")) ctl.turnOn(d);\n                break;\n            case CAMERA:\n                if (phrase.equalsIgnoreCase(\"start recording\")) ctl.turnOn(d);\n                break;\n            case SPRINKLER:\n                if (phrase.equalsIgnoreCase(\"water garden\")) ctl.turnOn(d);\n                break;\n        }\n    }\n}\n\nclass SceneManager {\n    private final SmartHomeController ctl = new SmartHomeController();\n    public void applyScene(String name, List<SmartDevice> devices) {\n        for (SmartDevice d : devices) {\n            switch (name) {\n                case \"Evening\":\n                    switch (d.getType()) {\n                        case LIGHT: ctl.turnOn(d); ctl.setMode(d, Mode.COMFORT); break;\n                        case THERMOSTAT: ctl.setMode(d, Mode.COMFORT); break;\n                        case CAMERA: ctl.turnOn(d); break;\n                        case DOOR_LOCK: ctl.turnOn(d); break;\n                        case SPRINKLER: ctl.turnOff(d); break;\n                    }\n                    break;\n                case \"Away\":\n                    switch (d.getType()) {\n                        case LIGHT: ctl.turnOff(d); break;\n                        case THERMOSTAT: ctl.setMode(d, Mode.AWAY); break;\n                        case CAMERA: ctl.turnOn(d); break;\n                        case DOOR_LOCK: ctl.turnOn(d); break;\n                        case SPRINKLER: ctl.turnOff(d); break;\n                    }\n                    break;\n            }\n        }\n    }\n}\n\nclass EnergyEstimator {\n    private final SmartHomeController ctl = new SmartHomeController();\n    public double estimateRoom(Room room, int minutes) {\n        double sum = 0;\n        for (SmartDevice d : room.getDevices()) sum += ctl.energyUsageKwh(d, minutes);\n        return sum;\n    }\n}\n",
      "output": "import java.util.*;\n\nenum DeviceType { LIGHT, THERMOSTAT, DOOR_LOCK, CAMERA, SPRINKLER }\nenum RoomType { LIVING, KITCHEN, BEDROOM, GARDEN }\nenum Mode { ECO, COMFORT, AWAY, NIGHT }\n\nclass SmartDevice {\n    private final String id;\n    private final DeviceType type;\n    private Mode mode = Mode.ECO;\n    private boolean online = true;\n\n    public SmartDevice(String id, DeviceType type) { this.id = id; this.type = type; }\n    public String getId() { return id; }\n    public DeviceType getType() { return type; }\n    public Mode getMode() { return mode; }\n    public boolean isOnline() { return online; }\n    public void setMode(Mode m) { this.mode = m; }\n    public void setOnline(boolean o) { this.online = o; }\n}\n\nclass Room {\n    private final String name;\n    private final RoomType type;\n    private final List<SmartDevice> devices = new ArrayList<>();\n    public Room(String name, RoomType type) { this.name = name; this.type = type; }\n    public void add(SmartDevice d) { devices.add(d); }\n    public List<SmartDevice> getDevices() { return devices; }\n    public String getName() { return name; }\n    public RoomType getType() { return type; }\n}\n\nclass ScheduleEntry {\n    public final SmartDevice device;\n    public final String cron;\n    public final String action;\n    public ScheduleEntry(SmartDevice device, String cron, String action) {\n        this.device = device; this.cron = cron; this.action = action;\n    }\n}\n\ninterface DeviceOps {\n    void turnOn(SmartDevice d);\n    void turnOff(SmartDevice d);\n    void setMode(SmartDevice d, Mode m);\n    double energyUsageKwh(int minutes);\n    String icon();\n    List<String> firmwareUpdateSteps();\n    void notifyOwner(SmartDevice d, String event);\n    String health(SmartDevice d);\n    double maintenanceCostYearly();\n    boolean actionAllowed(String action, boolean userHome);\n    void handleVoice(String phrase, SmartHomeController ctl, SmartDevice d);\n    void applyScene(String scene, SmartHomeController ctl, SmartDevice d);\n}\n\nclass DeviceOpsRegistry {\n    private static final Map<DeviceType, DeviceOps> map = new EnumMap<>(DeviceType.class);\n    static {\n        map.put(DeviceType.LIGHT, new LightOps());\n        map.put(DeviceType.THERMOSTAT, new ThermostatOps());\n        map.put(DeviceType.DOOR_LOCK, new DoorLockOps());\n        map.put(DeviceType.CAMERA, new CameraOps());\n        map.put(DeviceType.SPRINKLER, new SprinklerOps());\n    }\n    public static DeviceOps get(DeviceType t) { return map.get(t); }\n    public static void register(DeviceType t, DeviceOps ops) { map.put(t, ops); }\n}\n\nclass LightOps implements DeviceOps {\n    public void turnOn(SmartDevice d) { System.out.println(\"Light \" + d.getId() + \" ON\"); }\n    public void turnOff(SmartDevice d) { System.out.println(\"Light \" + d.getId() + \" OFF\"); }\n    public void setMode(SmartDevice d, Mode m) { d.setMode(m); System.out.println(\"Light \" + d.getId() + \" mode \" + m); }\n    public double energyUsageKwh(int minutes) { return 0.012 * minutes; }\n    public String icon() { return \"\"; }\n    public List<String> firmwareUpdateSteps() { return Arrays.asList(\"Ping\", \"Push FW\", \"Reboot\"); }\n    public void notifyOwner(SmartDevice d, String event) { System.out.println(\"Notify: Light \" + d.getId() + \" -> \" + event); }\n    public String health(SmartDevice d) { return d.isOnline() ? \"OK\" : \"Bulb Offline\"; }\n    public double maintenanceCostYearly() { return 5.0; }\n    public boolean actionAllowed(String action, boolean userHome) { return true; }\n    public void handleVoice(String phrase, SmartHomeController ctl, SmartDevice d) {\n        if (phrase.equalsIgnoreCase(\"lights on\")) ctl.turnOn(d);\n        else if (phrase.equalsIgnoreCase(\"lights off\")) ctl.turnOff(d);\n        else if (phrase.equalsIgnoreCase(\"night mode\")) ctl.setMode(d, Mode.NIGHT);\n    }\n    public void applyScene(String scene, SmartHomeController ctl, SmartDevice d) {\n        if (\"Evening\".equals(scene)) { ctl.turnOn(d); ctl.setMode(d, Mode.COMFORT); }\n        else if (\"Away\".equals(scene)) { ctl.turnOff(d); }\n    }\n}\n\nclass ThermostatOps implements DeviceOps {\n    public void turnOn(SmartDevice d) { System.out.println(\"Thermostat \" + d.getId() + \" heating\"); }\n    public void turnOff(SmartDevice d) { System.out.println(\"Thermostat \" + d.getId() + \" idle\"); }\n    public void setMode(SmartDevice d, Mode m) { d.setMode(m); System.out.println(\"Thermostat \" + d.getId() + \" mode \" + m); }\n    public double energyUsageKwh(int minutes) { return 0.08 * minutes; }\n    public String icon() { return \"\"; }\n    public List<String> firmwareUpdateSteps() { return Arrays.asList(\"Ping\", \"Backup Profile\", \"Push FW\", \"Recalibrate\"); }\n    public void notifyOwner(SmartDevice d, String event) { System.out.println(\"Notify: Thermostat \" + d.getId() + \" -> \" + event); }\n    public String health(SmartDevice d) { return d.isOnline() ? \"OK\" : \"Sensor Offline\"; }\n    public double maintenanceCostYearly() { return 20.0; }\n    public boolean actionAllowed(String action, boolean userHome) { return true; }\n    public void handleVoice(String phrase, SmartHomeController ctl, SmartDevice d) {\n        if (phrase.equalsIgnoreCase(\"heat on\")) ctl.turnOn(d);\n        else if (phrase.equalsIgnoreCase(\"eco mode\")) ctl.setMode(d, Mode.ECO);\n    }\n    public void applyScene(String scene, SmartHomeController ctl, SmartDevice d) {\n        if (\"Evening\".equals(scene)) { ctl.setMode(d, Mode.COMFORT); }\n        else if (\"Away\".equals(scene)) { ctl.setMode(d, Mode.AWAY); }\n    }\n}\n\nclass DoorLockOps implements DeviceOps {\n    public void turnOn(SmartDevice d) { System.out.println(\"Lock \" + d.getId() + \" stays locked\"); }\n    public void turnOff(SmartDevice d) { System.out.println(\"Lock \" + d.getId() + \" remains locked\"); }\n    public void setMode(SmartDevice d, Mode m) { d.setMode(m); System.out.println(\"Lock \" + d.getId() + \" mode \" + m); }\n    public double energyUsageKwh(int minutes) { return 0.0002 * minutes; }\n    public String icon() { return \"\"; }\n    public List<String> firmwareUpdateSteps() { return Arrays.asList(\"Ping\", \"Secure Channel\", \"Push FW\", \"Reauth\"); }\n    public void notifyOwner(SmartDevice d, String event) { System.out.println(\"Notify: Lock \" + d.getId() + \" -> \" + event); }\n    public String health(SmartDevice d) { return d.isOnline() ? \"OK\" : \"Battery Low\"; }\n    public double maintenanceCostYearly() { return 12.0; }\n    public boolean actionAllowed(String action, boolean userHome) { return action.equals(\"unlock\") ? userHome : true; }\n    public void handleVoice(String phrase, SmartHomeController ctl, SmartDevice d) {\n        if (phrase.equalsIgnoreCase(\"lock door\")) ctl.turnOn(d);\n    }\n    public void applyScene(String scene, SmartHomeController ctl, SmartDevice d) {\n        if (\"Evening\".equals(scene) || \"Away\".equals(scene)) { ctl.turnOn(d); }\n    }\n}\n\nclass CameraOps implements DeviceOps {\n    public void turnOn(SmartDevice d) { System.out.println(\"Camera \" + d.getId() + \" recording\"); }\n    public void turnOff(SmartDevice d) { System.out.println(\"Camera \" + d.getId() + \" standby\"); }\n    public void setMode(SmartDevice d, Mode m) { d.setMode(m); System.out.println(\"Camera \" + d.getId() + \" mode \" + m); }\n    public double energyUsageKwh(int minutes) { return 0.01 * minutes; }\n    public String icon() { return \"\"; }\n    public List<String> firmwareUpdateSteps() { return Arrays.asList(\"Ping\", \"Push FW\", \"Restart Stream\"); }\n    public void notifyOwner(SmartDevice d, String event) { System.out.println(\"Notify: Camera \" + d.getId() + \" -> \" + event); }\n    public String health(SmartDevice d) { return d.isOnline() ? \"OK\" : \"Stream Error\"; }\n    public double maintenanceCostYearly() { return 18.0; }\n    public boolean actionAllowed(String action, boolean userHome) { return true; }\n    public void handleVoice(String phrase, SmartHomeController ctl, SmartDevice d) {\n        if (phrase.equalsIgnoreCase(\"start recording\")) ctl.turnOn(d);\n    }\n    public void applyScene(String scene, SmartHomeController ctl, SmartDevice d) {\n        if (\"Evening\".equals(scene) || \"Away\".equals(scene)) { ctl.turnOn(d); }\n    }\n}\n\nclass SprinklerOps implements DeviceOps {\n    public void turnOn(SmartDevice d) { System.out.println(\"Sprinkler \" + d.getId() + \" watering\"); }\n    public void turnOff(SmartDevice d) { System.out.println(\"Sprinkler \" + d.getId() + \" stopped\"); }\n    public void setMode(SmartDevice d, Mode m) { d.setMode(m); System.out.println(\"Sprinkler \" + d.getId() + \" mode \" + m); }\n    public double energyUsageKwh(int minutes) { return 0.03 * minutes; }\n    public String icon() { return \"\"; }\n    public List<String> firmwareUpdateSteps() { return Arrays.asList(\"Ping\", \"Push FW\", \"Valve Test\"); }\n    public void notifyOwner(SmartDevice d, String event) { System.out.println(\"Notify: Sprinkler \" + d.getId() + \" -> \" + event); }\n    public String health(SmartDevice d) { return d.isOnline() ? \"OK\" : \"Valve Error\"; }\n    public double maintenanceCostYearly() { return 15.0; }\n    public boolean actionAllowed(String action, boolean userHome) { return !action.equals(\"on\") || !userHome; }\n    public void handleVoice(String phrase, SmartHomeController ctl, SmartDevice d) {\n        if (phrase.equalsIgnoreCase(\"water garden\")) ctl.turnOn(d);\n    }\n    public void applyScene(String scene, SmartHomeController ctl, SmartDevice d) {\n        if (\"Evening\".equals(scene) || \"Away\".equals(scene)) { ctl.turnOff(d); }\n    }\n}\n\nclass SmartHomeController {\n    public void turnOn(SmartDevice d) { DeviceOpsRegistry.get(d.getType()).turnOn(d); }\n    public void turnOff(SmartDevice d) { DeviceOpsRegistry.get(d.getType()).turnOff(d); }\n    public void setMode(SmartDevice d, Mode m) { DeviceOpsRegistry.get(d.getType()).setMode(d, m); }\n    public double energyUsageKwh(SmartDevice d, int minutes) { return DeviceOpsRegistry.get(d.getType()).energyUsageKwh(minutes); }\n    public String deviceIcon(SmartDevice d) { return DeviceOpsRegistry.get(d.getType()).icon(); }\n    public List<String> firmwareUpdateSteps(SmartDevice d) { return DeviceOpsRegistry.get(d.getType()).firmwareUpdateSteps(); }\n}\n\nclass NotificationService {\n    public void notifyOwner(SmartDevice d, String event) { DeviceOpsRegistry.get(d.getType()).notifyOwner(d, event); }\n}\n\nclass DiagnosticsService {\n    public String health(SmartDevice d) { return DeviceOpsRegistry.get(d.getType()).health(d); }\n    public double maintenanceCostYearly(SmartDevice d) { return DeviceOpsRegistry.get(d.getType()).maintenanceCostYearly(); }\n}\n\nclass SecurityPolicy {\n    public boolean actionAllowed(SmartDevice d, String action, boolean userHome) {\n        return DeviceOpsRegistry.get(d.getType()).actionAllowed(action, userHome);\n    }\n}\n\nclass VoiceCommandProcessor {\n    private final SmartHomeController ctl = new SmartHomeController();\n    public void handle(String phrase, SmartDevice d) {\n        DeviceOpsRegistry.get(d.getType()).handleVoice(phrase, ctl, d);\n    }\n}\n\nclass SceneManager {\n    private final SmartHomeController ctl = new SmartHomeController();\n    public void applyScene(String name, List<SmartDevice> devices) {\n        for (SmartDevice d : devices) DeviceOpsRegistry.get(d.getType()).applyScene(name, ctl, d);\n    }\n}\n\nclass EnergyEstimator {\n    private final SmartHomeController ctl = new SmartHomeController();\n    public double estimateRoom(Room room, int minutes) {\n        double sum = 0;\n        for (SmartDevice d : room.getDevices()) sum += ctl.energyUsageKwh(d, minutes);\n        return sum;\n    }\n}\n",
      "level": "MODERATE",
      "language": "JAVA",
      "violation": "OCP"
    }
  ]
}