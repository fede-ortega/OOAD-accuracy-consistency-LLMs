{
  "code_examples": [
    {
      "input": "public class MySQLDatabase {\n    public void connect() {\n        System.out.println(\"Connected to MySQL\");\n    }\n    \n    public String getUserEmail(int userId) {\n        return \"user\" + userId + \"@example.com\";\n    }\n}\n\npublic class EmailService {\n    private MySQLDatabase database;\n    \n    public EmailService() {\n        this.database = new MySQLDatabase();\n    }\n    \n    public void sendEmail(int userId, String message) {\n        database.connect();\n        String email = database.getUserEmail(userId);\n        System.out.println(\"Sending email to \" + email + \": \" + message);\n    }\n}",
      "output": "interface Database {\n    void connect();\n    String getUserEmail(int userId);\n}\n\npublic class MySQLDatabase implements Database {\n    public void connect() {\n        System.out.println(\"Connected to MySQL\");\n    }\n    \n    public String getUserEmail(int userId) {\n        return \"user\" + userId + \"@example.com\";\n    }\n}\n\npublic class EmailService {\n    private Database database;\n    \n    public EmailService(Database database) {\n        this.database = database;\n    }\n    \n    public void sendEmail(int userId, String message) {\n        database.connect();\n        String email = database.getUserEmail(userId);\n        System.out.println(\"Sending email to \" + email + \": \" + message);\n    }\n}",
      "level": "EASY",
      "language": "JAVA",
      "violation": "DIP"
    },
    {
      "input": "class MySQLDatabase:\n    def connect(self):\n        print(\"Connected to MySQL\")\n    \n    def get_user_email(self, user_id):\n        return f\"user{user_id}@example.com\"\n\nclass EmailService:\n    def **init**(self):\n        self.database = MySQLDatabase()\n    \n    def send_email(self, user_id, message):\n        self.database.connect()\n        email = self.database.get_user_email(user_id)\n        print(f\"Sending email to {email}: {message}\")",
      "output": "from abc import ABC, abstractmethod\n\nclass Database(ABC):\n    @abstractmethod\n    def connect(self):\n        pass\n    \n    @abstractmethod\n    def get_user_email(self, user_id):\n        pass\n\nclass MySQLDatabase(Database):\n    def connect(self):\n        print(\"Connected to MySQL\")\n    \n    def get_user_email(self, user_id):\n        return f\"user{user_id}@example.com\"\n\nclass EmailService:\n    def __init__(self, database: Database):\n        self.database = database\n    \n    def send_email(self, user_id, message):\n        self.database.connect()\n        email = self.database.get_user_email(user_id)\n        print(f\"Sending email to {email}: {message}\")",
      "level": "EASY",
      "language": "PYTHON",
      "violation": "DIP"
    },
    {
      "input": "public class MySQLDatabase {\n    private String connectionString;\n    private boolean isConnected;\n    \n    public MySQLDatabase(String connectionString) {\n        this.connectionString = connectionString;\n        this.isConnected = false;\n    }\n    \n    public void connect() {\n        if (!isConnected) {\n            System.out.println(\"Connecting to MySQL with: \" + connectionString);\n            isConnected = true;\n        }\n    }\n    \n    public void disconnect() {\n        if (isConnected) {\n            System.out.println(\"Disconnecting from MySQL\");\n            isConnected = false;\n        }\n    }\n    \n    public String getUserEmail(int userId) {\n        if (!isConnected) {\n            throw new RuntimeException(\"Database not connected\");\n        }\n        return \"user\" + userId + \"@company.com\";\n    }\n    \n    public boolean validateUser(int userId) {\n        if (!isConnected) {\n            throw new RuntimeException(\"Database not connected\");\n        }\n        return userId > 0 && userId < 10000;\n    }\n}\n\npublic class EmailService {\n    private MySQLDatabase database;\n    private String smtpServer;\n    \n    public EmailService(String smtpServer) {\n        this.smtpServer = smtpServer;\n        this.database = new MySQLDatabase(\"jdbc:mysql://localhost:3306/users\");\n    }\n    \n    public void sendEmail(int userId, String subject, String message) {\n        database.connect();\n        \n        if (!database.validateUser(userId)) {\n            System.out.println(\"Invalid user ID: \" + userId);\n            return;\n        }\n        \n        String email = database.getUserEmail(userId);\n        System.out.println(\"Using SMTP server: \" + smtpServer);\n        System.out.println(\"Sending email to \" + email);\n        System.out.println(\"Subject: \" + subject);\n        System.out.println(\"Message: \" + message);\n        \n        database.disconnect();\n    }\n    \n    public void sendBulkEmails(int[] userIds, String subject, String message) {\n        database.connect();\n        \n        for (int userId : userIds) {\n            if (database.validateUser(userId)) {\n                String email = database.getUserEmail(userId);\n                System.out.println(\"Bulk email sent to: \" + email);\n            }\n        }\n        \n        database.disconnect();\n    }\n}",
      "output": "interface Database {\n    void connect();\n    void disconnect();\n    String getUserEmail(int userId);\n    boolean validateUser(int userId);\n}\n\npublic class MySQLDatabase implements Database {\n    private String connectionString;\n    private boolean isConnected;\n    \n    public MySQLDatabase(String connectionString) {\n        this.connectionString = connectionString;\n        this.isConnected = false;\n    }\n    \n    public void connect() {\n        if (!isConnected) {\n            System.out.println(\"Connecting to MySQL with: \" + connectionString);\n            isConnected = true;\n        }\n    }\n    \n    public void disconnect() {\n        if (isConnected) {\n            System.out.println(\"Disconnecting from MySQL\");\n            isConnected = false;\n        }\n    }\n    \n    public String getUserEmail(int userId) {\n        if (!isConnected) {\n            throw new RuntimeException(\"Database not connected\");\n        }\n        return \"user\" + userId + \"@company.com\";\n    }\n    \n    public boolean validateUser(int userId) {\n        if (!isConnected) {\n            throw new RuntimeException(\"Database not connected\");\n        }\n        return userId > 0 && userId < 10000;\n    }\n}\n\npublic class EmailService {\n    private Database database;\n    private String smtpServer;\n    \n    public EmailService(String smtpServer, Database database) {\n        this.smtpServer = smtpServer;\n        this.database = database;\n    }\n    \n    public void sendEmail(int userId, String subject, String message) {\n        database.connect();\n        \n        if (!database.validateUser(userId)) {\n            System.out.println(\"Invalid user ID: \" + userId);\n            return;\n        }\n        \n        String email = database.getUserEmail(userId);\n        System.out.println(\"Using SMTP server: \" + smtpServer);\n        System.out.println(\"Sending email to \" + email);\n        System.out.println(\"Subject: \" + subject);\n        System.out.println(\"Message: \" + message);\n        \n        database.disconnect();\n    }\n    \n    public void sendBulkEmails(int[] userIds, String subject, String message) {\n        database.connect();\n        \n        for (int userId : userIds) {\n            if (database.validateUser(userId)) {\n                String email = database.getUserEmail(userId);\n                System.out.println(\"Bulk email sent to: \" + email);\n            }\n        }\n        \n        database.disconnect();\n    }\n}",
      "level": "MODERATE",
      "language": "JAVA",
      "violation": "DIP"
    },
    {
      "input": "class MySQLDatabase:\n    def **init**(self, connection_string):\n        self.connection_string = connection_string\n        self.is_connected = False\n    \n    def connect(self):\n        if not self.is_connected:\n            print(f\"Connecting to MySQL with: {self.connection_string}\")\n            self.is_connected = True\n    \n    def disconnect(self):\n        if self.is_connected:\n            print(\"Disconnecting from MySQL\")\n            self.is_connected = False\n    \n    def get_user_email(self, user_id):\n        if not self.is_connected:\n            raise RuntimeError(\"Database not connected\")\n        return f\"user{user_id}@company.com\"\n    \n    def validate_user(self, user_id):\n        if not self.is_connected:\n            raise RuntimeError(\"Database not connected\")\n        return user_id > 0 and user_id < 10000\n\nclass EmailService:\n    def **init**(self, smtp_server):\n        self.smtp_server = smtp_server\n        self.database = MySQLDatabase(\"mysql://localhost:3306/users\")\n    \n    def send_email(self, user_id, subject, message):\n        self.database.connect()\n        \n        if not self.database.validate_user(user_id):\n            print(f\"Invalid user ID: {user_id}\")\n            return\n        \n        email = self.database.get_user_email(user_id)\n        print(f\"Using SMTP server: {self.smtp_server}\")\n        print(f\"Sending email to {email}\")\n        print(f\"Subject: {subject}\")\n        print(f\"Message: {message}\")\n        \n        self.database.disconnect()\n    \n    def send_bulk_emails(self, user_ids, subject, message):\n        self.database.connect()\n        \n        for user_id in user_ids:\n            if self.database.validate_user(user_id):\n                email = self.database.get_user_email(user_id)\n                print(f\"Bulk email sent to: {email}\")\n        \n        self.database.disconnect()",
      "output": "from abc import ABC, abstractmethod\n\nclass Database(ABC):\n    @abstractmethod\n    def connect(self):\n        pass\n    \n    @abstractmethod\n    def disconnect(self):\n        pass\n    \n    @abstractmethod\n    def get_user_email(self, user_id):\n        pass\n    \n    @abstractmethod\n    def validate_user(self, user_id):\n        pass\n\nclass MySQLDatabase(Database):\n    def __init__(self, connection_string):\n        self.connection_string = connection_string\n        self.is_connected = False\n    \n    def connect(self):\n        if not self.is_connected:\n            print(f\"Connecting to MySQL with: {self.connection_string}\")\n            self.is_connected = True\n    \n    def disconnect(self):\n        if self.is_connected:\n            print(\"Disconnecting from MySQL\")\n            self.is_connected = False\n    \n    def get_user_email(self, user_id):\n        if not self.is_connected:\n            raise RuntimeError(\"Database not connected\")\n        return f\"user{user_id}@company.com\"\n    \n    def validate_user(self, user_id):\n        if not self.is_connected:\n            raise RuntimeError(\"Database not connected\")\n        return user_id > 0 and user_id < 10000\n\nclass EmailService:\n    def __init__(self, smtp_server, database: Database):\n        self.smtp_server = smtp_server\n        self.database = database\n    \n    def send_email(self, user_id, subject, message):\n        self.database.connect()\n        \n        if not self.database.validate_user(user_id):\n            print(f\"Invalid user ID: {user_id}\")\n            return\n        \n        email = self.database.get_user_email(user_id)\n        print(f\"Using SMTP server: {self.smtp_server}\")\n        print(f\"Sending email to {email}\")\n        print(f\"Subject: {subject}\")\n        print(f\"Message: {message}\")\n        \n        self.database.disconnect()\n    \n    def send_bulk_emails(self, user_ids, subject, message):\n        self.database.connect()\n        \n        for user_id in user_ids:\n            if self.database.validate_user(user_id):\n                email = self.database.get_user_email(user_id)\n                print(f\"Bulk email sent to: {email}\")\n        \n        self.database.disconnect()",
      "level": "MODERATE",
      "language": "PYTHON",
      "violation": "DIP"
    },
    {
      "input": "import java.util.*;\nimport java.util.concurrent.*;\n\npublic class MySQLDatabase {\n    private String connectionString;\n    private Properties connectionProperties;\n    private boolean isConnected;\n    private int connectionTimeout;\n    private ExecutorService connectionPool;\n    \n    public MySQLDatabase(String connectionString, Properties properties) {\n        this.connectionString = connectionString;\n        this.connectionProperties = properties;\n        this.isConnected = false;\n        this.connectionTimeout = 30;\n        this.connectionPool = Executors.newFixedThreadPool(10);\n    }\n    \n    public void connect() throws Exception {\n        if (!isConnected) {\n            System.out.println(\"Establishing MySQL connection with: \" + connectionString);\n            Thread.sleep(connectionTimeout);\n            isConnected = true;\n            System.out.println(\"MySQL connection established successfully\");\n        }\n    }\n    \n    public void disconnect() {\n        if (isConnected) {\n            System.out.println(\"Closing MySQL connection\");\n            isConnected = false;\n            connectionPool.shutdown();\n        }\n    }\n    \n    public String getUserEmail(int userId) throws Exception {\n        if (!isConnected) {\n            throw new RuntimeException(\"Database connection not established\");\n        }\n        \n        Future<String> future = connectionPool.submit(() -> {\n            try {\n                Thread.sleep(10);\n                return \"user\" + userId + \"@enterprise.com\";\n            } catch (InterruptedException e) {\n                throw new RuntimeException(e);\n            }\n        });\n        \n        return future.get(5, TimeUnit.SECONDS);\n    }\n    \n    public boolean validateUser(int userId) throws Exception {\n        if (!isConnected) {\n            throw new RuntimeException(\"Database connection not established\");\n        }\n        \n        Future<Boolean> future = connectionPool.submit(() -> {\n            try {\n                Thread.sleep(5);\n                return userId > 0 && userId < 100000;\n            } catch (InterruptedException e) {\n                throw new RuntimeException(e);\n            }\n        });\n        \n        return future.get(3, TimeUnit.SECONDS);\n    }\n    \n    public List<String> getUserGroups(int userId) throws Exception {\n        if (!isConnected) {\n            throw new RuntimeException(\"Database connection not established\");\n        }\n        \n        Future<List<String>> future = connectionPool.submit(() -> {\n            try {\n                Thread.sleep(15);\n                List<String> groups = new ArrayList<>();\n                groups.add(\"general\");\n                groups.add(\"department_\" + (userId % 10));\n                return groups;\n            } catch (InterruptedException e) {\n                throw new RuntimeException(e);\n            }\n        });\n        \n        return future.get(10, TimeUnit.SECONDS);\n    }\n    \n    public void updateEmailSentStatus(int userId, String messageId) throws Exception {\n        if (!isConnected) {\n            throw new RuntimeException(\"Database connection not established\");\n        }\n        \n        connectionPool.submit(() -> {\n            try {\n                Thread.sleep(20);\n                System.out.println(\"Email status updated for user \" + userId + \", message: \" + messageId);\n            } catch (InterruptedException e) {\n                throw new RuntimeException(e);\n            }\n        });\n    }\n}\n\npublic class EmailService {\n    private MySQLDatabase database;\n    private String smtpServer;\n    private int smtpPort;\n    private String smtpUsername;\n    private String smtpPassword;\n    private boolean useSSL;\n    \n    public EmailService(String smtpServer, int smtpPort, String username, String password, boolean useSSL) {\n        this.smtpServer = smtpServer;\n        this.smtpPort = smtpPort;\n        this.smtpUsername = username;\n        this.smtpPassword = password;\n        this.useSSL = useSSL;\n        \n        Properties dbProperties = new Properties();\n        dbProperties.setProperty(\"useSSL\", \"true\");\n        dbProperties.setProperty(\"serverTimezone\", \"UTC\");\n        \n        this.database = new MySQLDatabase(\"jdbc:mysql://localhost:3306/enterprise_users?useSSL=true&serverTimezone=UTC\", dbProperties);\n    }\n    \n    public void sendEmail(int userId, String subject, String message, String priority) throws Exception {\n        database.connect();\n        \n        try {\n            if (!database.validateUser(userId)) {\n                System.out.println(\"User validation failed for ID: \" + userId);\n                return;\n            }\n            \n            String email = database.getUserEmail(userId);\n            List<String> groups = database.getUserGroups(userId);\n            \n            System.out.println(\"Configuring SMTP connection:\");\n            System.out.println(\"Server: \" + smtpServer + \":\" + smtpPort);\n            System.out.println(\"SSL: \" + useSSL);\n            System.out.println(\"Authentication: \" + smtpUsername);\n            \n            String messageId = UUID.randomUUID().toString();\n            \n            System.out.println(\"Sending email:\");\n            System.out.println(\"To: \" + email);\n            System.out.println(\"Subject: \" + subject);\n            System.out.println(\"Message: \" + message);\n            System.out.println(\"Priority: \" + priority);\n            System.out.println(\"User Groups: \" + groups);\n            System.out.println(\"Message ID: \" + messageId);\n            \n            database.updateEmailSentStatus(userId, messageId);\n            \n        } finally {\n            database.disconnect();\n        }\n    }\n    \n    public void sendBulkEmails(int[] userIds, String subject, String message, String priority) throws Exception {\n        database.connect();\n        \n        try {\n            List<Future<Void>> futures = new ArrayList<>();\n            ExecutorService executor = Executors.newFixedThreadPool(5);\n            \n            for (int userId : userIds) {\n                futures.add(executor.submit(() -> {\n                    try {\n                        if (database.validateUser(userId)) {\n                            String email = database.getUserEmail(userId);\n                            List<String> groups = database.getUserGroups(userId);\n                            String messageId = UUID.randomUUID().toString();\n                            \n                            System.out.println(\"Bulk email sent to: \" + email + \" (Groups: \" + groups + \")\");\n                            database.updateEmailSentStatus(userId, messageId);\n                        }\n                    } catch (Exception e) {\n                        System.err.println(\"Failed to send email to user \" + userId + \": \" + e.getMessage());\n                    }\n                    return null;\n                }));\n            }\n            \n            for (Future<Void> future : futures) {\n                future.get();\n            }\n            \n            executor.shutdown();\n            \n        } finally {\n            database.disconnect();\n        }\n    }\n    \n    public void sendScheduledEmails(Map<Integer, String> userMessages, String subject, long delaySeconds) throws Exception {\n        database.connect();\n        \n        try {\n            ScheduledExecutorService scheduler = Executors.newScheduledThreadPool(3);\n            \n            for (Map.Entry<Integer, String> entry : userMessages.entrySet()) {\n                int userId = entry.getKey();\n                String personalizedMessage = entry.getValue();\n                \n                scheduler.schedule(() -> {\n                    try {\n                        if (database.validateUser(userId)) {\n                            String email = database.getUserEmail(userId);\n                            List<String> groups = database.getUserGroups(userId);\n                            String messageId = UUID.randomUUID().toString();\n                            \n                            System.out.println(\"Scheduled email sent to: \" + email);\n                            System.out.println(\"Personalized message: \" + personalizedMessage);\n                            database.updateEmailSentStatus(userId, messageId);\n                        }\n                    } catch (Exception e) {\n                        System.err.println(\"Failed to send scheduled email to user \" + userId + \": \" + e.getMessage());\n                    }\n                }, delaySeconds, TimeUnit.SECONDS);\n            }\n            \n        } finally {\n            database.disconnect();\n        }\n    }\n}",
      "output": "import java.util.*;\nimport java.util.concurrent.*;\n\ninterface DatabaseService {\n    void connect() throws Exception;\n    void disconnect();\n    String getUserEmail(int userId) throws Exception;\n    boolean validateUser(int userId) throws Exception;\n    List<String> getUserGroups(int userId) throws Exception;\n    void updateEmailSentStatus(int userId, String messageId) throws Exception;\n}\n\npublic class MySQLDatabase implements DatabaseService {\n    private String connectionString;\n    private Properties connectionProperties;\n    private boolean isConnected;\n    private int connectionTimeout;\n    private ExecutorService connectionPool;\n    \n    public MySQLDatabase(String connectionString, Properties properties) {\n        this.connectionString = connectionString;\n        this.connectionProperties = properties;\n        this.isConnected = false;\n        this.connectionTimeout = 30;\n        this.connectionPool = Executors.newFixedThreadPool(10);\n    }\n    \n    @Override\n    public void connect() throws Exception {\n        if (!isConnected) {\n            System.out.println(\"Establishing MySQL connection with: \" + connectionString);\n            Thread.sleep(connectionTimeout);\n            isConnected = true;\n            System.out.println(\"MySQL connection established successfully\");\n        }\n    }\n    \n    @Override\n    public void disconnect() {\n        if (isConnected) {\n            System.out.println(\"Closing MySQL connection\");\n            isConnected = false;\n            connectionPool.shutdown();\n        }\n    }\n    \n    @Override\n    public String getUserEmail(int userId) throws Exception {\n        if (!isConnected) {\n            throw new RuntimeException(\"Database connection not established\");\n        }\n        \n        Future<String> future = connectionPool.submit(() -> {\n            try {\n                Thread.sleep(10);\n                return \"user\" + userId + \"@enterprise.com\";\n            } catch (InterruptedException e) {\n                throw new RuntimeException(e);\n            }\n        });\n        \n        return future.get(5, TimeUnit.SECONDS);\n    }\n    \n    @Override\n    public boolean validateUser(int userId) throws Exception {\n        if (!isConnected) {\n            throw new RuntimeException(\"Database connection not established\");\n        }\n        \n        Future<Boolean> future = connectionPool.submit(() -> {\n            try {\n                Thread.sleep(5);\n                return userId > 0 && userId < 100000;\n            } catch (InterruptedException e) {\n                throw new RuntimeException(e);\n            }\n        });\n        \n        return future.get(3, TimeUnit.SECONDS);\n    }\n    \n    @Override\n    public List<String> getUserGroups(int userId) throws Exception {\n        if (!isConnected) {\n            throw new RuntimeException(\"Database connection not established\");\n        }\n        \n        Future<List<String>> future = connectionPool.submit(() -> {\n            try {\n                Thread.sleep(15);\n                List<String> groups = new ArrayList<>();\n                groups.add(\"general\");\n                groups.add(\"department_\" + (userId % 10));\n                return groups;\n            } catch (InterruptedException e) {\n                throw new RuntimeException(e);\n            }\n        });\n        \n        return future.get(10, TimeUnit.SECONDS);\n    }\n    \n    @Override\n    public void updateEmailSentStatus(int userId, String messageId) throws Exception {\n        if (!isConnected) {\n            throw new RuntimeException(\"Database connection not established\");\n        }\n        \n        connectionPool.submit(() -> {\n            try {\n                Thread.sleep(20);\n                System.out.println(\"Email status updated for user \" + userId + \", message: \" + messageId);\n            } catch (InterruptedException e) {\n                throw new RuntimeException(e);\n            }\n        });\n    }\n}\n\npublic class EmailService {\n    private DatabaseService database;\n    private String smtpServer;\n    private int smtpPort;\n    private String smtpUsername;\n    private String smtpPassword;\n    private boolean useSSL;\n    \n    public EmailService(String smtpServer, int smtpPort, String username, String password, boolean useSSL, DatabaseService database) {\n        this.smtpServer = smtpServer;\n        this.smtpPort = smtpPort;\n        this.smtpUsername = username;\n        this.smtpPassword = password;\n        this.useSSL = useSSL;\n        this.database = database;\n    }\n    \n    public void sendEmail(int userId, String subject, String message, String priority) throws Exception {\n        database.connect();\n        \n        try {\n            if (!database.validateUser(userId)) {\n                System.out.println(\"User validation failed for ID: \" + userId);\n                return;\n            }\n            \n            String email = database.getUserEmail(userId);\n            List<String> groups = database.getUserGroups(userId);\n            \n            System.out.println(\"Configuring SMTP connection:\");\n            System.out.println(\"Server: \" + smtpServer + \":\" + smtpPort);\n            System.out.println(\"SSL: \" + useSSL);\n            System.out.println(\"Authentication: \" + smtpUsername);\n            \n            String messageId = UUID.randomUUID().toString();\n            \n            System.out.println(\"Sending email:\");\n            System.out.println(\"To: \" + email);\n            System.out.println(\"Subject: \" + subject);\n            System.out.println(\"Message: \" + message);\n            System.out.println(\"Priority: \" + priority);\n            System.out.println(\"User Groups: \" + groups);\n            System.out.println(\"Message ID: \" + messageId);\n            \n            database.updateEmailSentStatus(userId, messageId);\n            \n        } finally {\n            database.disconnect();\n        }\n    }\n    \n    public void sendBulkEmails(int[] userIds, String subject, String message, String priority) throws Exception {\n        database.connect();\n        \n        try {\n            List<Future<Void>> futures = new ArrayList<>();\n            ExecutorService executor = Executors.newFixedThreadPool(5);\n            \n            for (int userId : userIds) {\n                futures.add(executor.submit(() -> {\n                    try {\n                        if (database.validateUser(userId)) {\n                            String email = database.getUserEmail(userId);\n                            List<String> groups = database.getUserGroups(userId);\n                            String messageId = UUID.randomUUID().toString();\n                            \n                            System.out.println(\"Bulk email sent to: \" + email + \" (Groups: \" + groups + \")\");\n                            database.updateEmailSentStatus(userId, messageId);\n                        }\n                    } catch (Exception e) {\n                        System.err.println(\"Failed to send email to user \" + userId + \": \" + e.getMessage());\n                    }\n                    return null;\n                }));\n            }\n            \n            for (Future<Void> future : futures) {\n                future.get();\n            }\n            \n            executor.shutdown();\n            \n        } finally {\n            database.disconnect();\n        }\n    }\n    \n    public void sendScheduledEmails(Map<Integer, String> userMessages, String subject, long delaySeconds) throws Exception {\n        database.connect();\n        \n        try {\n            ScheduledExecutorService scheduler = Executors.newScheduledThreadPool(3);\n            \n            for (Map.Entry<Integer, String> entry : userMessages.entrySet()) {\n                int userId = entry.getKey();\n                String personalizedMessage = entry.getValue();\n                \n                scheduler.schedule(() -> {\n                    try {\n                        if (database.validateUser(userId)) {\n                            String email = database.getUserEmail(userId);\n                            List<String> groups = database.getUserGroups(userId);\n                            String messageId = UUID.randomUUID().toString();\n                            \n                            System.out.println(\"Scheduled email sent to: \" + email);\n                            System.out.println(\"Personalized message: \" + personalizedMessage);\n                            database.updateEmailSentStatus(userId, messageId);\n                        }\n                    } catch (Exception e) {\n                        System.err.println(\"Failed to send scheduled email to user \" + userId + \": \" + e.getMessage());\n                    }\n                }, delaySeconds, TimeUnit.SECONDS);\n            }\n            \n        } finally {\n            database.disconnect();\n        }\n    }\n}",
      "level": "HARD",
      "language": "JAVA",
      "violation": "DIP"
    }
  ]
}